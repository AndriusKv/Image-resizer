!function e(t,n,r){function o(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[a]={exports:{}};t[a][0].call(d.exports,function(e){var n=t[a][1][e];return o(n?n:e)},d,d.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,n){"use strict";function r(e){return e>180&&(e-=360),e*Math.PI/180}function o(e){var t=Math.round(180*e/Math.PI);return 0>t&&(t+=360),t}function i(e,t){if("rad"===t)return u=r(e);if("deg"===t){var n=o(e);return u=0===n||360===n?0:e,n}}function a(){return u}function s(){u=0}Object.defineProperty(n,"__esModule",{value:!0});var u=0;n.set=i,n.get=a,n.reset=s,n.convertRadiansToDegrees=o},{}],2:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e){var t=document.getElementById("js-canvas");e?(t.addEventListener("mousemove",p),window.addEventListener("keydown",m)):(t.removeEventListener("mousemove",p),window.removeEventListener("keydown",m))}function i(){var e=arguments.length<=0||void 0===arguments[0]?k:arguments[0],t=document.getElementById("js-crop"),n=e===k;n?(k="",t.removeEventListener("mousemove",a),t.removeEventListener("mouseup",s)):(k=e,t.addEventListener("mousemove",a),t.addEventListener("mouseup",s)),o(n)}function a(e){e.target!==document.getElementById("js-canvas")&&e.preventDefault();var t=I.getMousePosition(e),n=t.x,r=t.y,o=L.get();switch(k){case"select":u(o,n,r);break;case"resize":c(o,n,r);break;case"rotate":g(o,n,r);break;case"move":if(!e.ctrlKey)return;l(n,r);break;case"drag":if(!e.shiftKey)return;f(n,r)}o.width&&o.height&&"rotate"!==k&&y.updateTransformedArea(o),requestAnimationFrame(y.draw)}function s(){var e=L.get(),t=e.width&&e.height;if(i(),!t){var n=I.transform.getTransform(),r=L.reset(),o=I.getImage(M.useImageWithQuality());x.updateDataDisplay(r),L.setProp("x",n.e),L.setProp("y",n.f),I.drawImage(o),I.setCursor()}L.setHasArea(t),x.toggleButtons(!t)}function u(e,t,n){L.setProp("width",t-e.x),L.setProp("height",n-e.y),L.setHasArea(!0)}function c(e,t,n){var r=C.get(),o="";if(-1!==r.indexOf("n")?(L.setProp("height",e.y-n+e.height),L.setProp("y",n),o="n"):-1!==r.indexOf("s")&&(L.setProp("height",n-e.y),o="s"),-1!==r.indexOf("w")?(L.setProp("width",e.x-t+e.width),L.setProp("x",t),o+="e"):-1!==r.indexOf("e")&&(L.setProp("width",t-e.x),o+="w"),o.length>1){var i=C.reverse(r,o,e);I.setCursor(i+"-resize")}}function d(e,t,n){var r=e.x+e.width/2,o=e.y+e.height/2;return Math.atan2(o-n,r-t)}function g(e,t,n){var r=d(e,t,n),o=A.set(r,"deg");x.cropDataInputs.setValue("angle",o)}function l(e,t){var n=y.mousePosition.get();L.setProp("x",e-n.x),L.setProp("y",t-n.y)}function f(e,t){var n=y.mousePosition.get();if(n){var r=I.transform,o=r.getTransformedPoint(e,t);r.translate(o.x-n.x,o.y-n.y)}}function h(){I.setCursor(),window.removeEventListener("keyup",h)}function m(e){var t=A.get(),n=L.get(),r=y.mousePosition.get(),o=r.x,i=r.y;e.ctrlKey&&L.isInside(n,o,i,t)&&I.setCursor("move"),window.addEventListener("keyup",h)}function v(e,t,n){var r=C.getOpposite(t,n,e),o="default";r&&(o=r+"-resize"),I.setCursor(o)}function p(e){var t=I.getMousePosition(e),n=t.x,r=t.y,o=L.get(),i=A.get();if(y.mousePosition.set({x:n,y:r}),o.width&&o.height){if(e.ctrlKey){var a="default";return L.isInside(o,n,r,i)&&(a="move"),void I.setCursor(a)}i||v(o,n,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.toggleCursorEvents=n.toggleEvent=void 0;var w=e("./cropper.js"),y=r(w),j=e("./cropper.canvas.js"),I=r(j),b=e("./cropper.sidebar.js"),x=r(b),E=e("./cropper.selected-area.js"),L=r(E),P=e("./cropper.direction.js"),C=r(P),D=e("./cropper.angle.js"),A=r(D),B=e("./cropper.quality.js"),M=r(B),k="";n.toggleEvent=i,n.toggleCursorEvents=o},{"./cropper.angle.js":1,"./cropper.canvas.js":3,"./cropper.direction.js":4,"./cropper.js":5,"./cropper.quality.js":6,"./cropper.selected-area.js":8,"./cropper.sidebar.js":9}],3:[function(e,t,n){"use strict";function r(){return b.getContext("2d")}function o(){return{width:b.width,height:b.height}}function i(e,t){b.width=e,t&&(b.height=t)}function a(e,t){b.addEventListener(e,t)}function s(e,t){b.removeEventListener(e,t)}function u(){b.classList.add("show")}function c(){b.classList.remove("show")}function d(){var e=arguments.length<=0||void 0===arguments[0]?"default":arguments[0];b.style.cursor=e}function g(e){var t=e.clientX,n=e.clientY,r=b.getBoundingClientRect(),o=r.left,i=r.top;return{x:t-o,y:n-i}}function l(){return E}function f(e){return{width:x.width,height:x.height,src:e?x.withQuality:x.original}}function h(e){var t=o(),n=t.width,r=t.height;e.fillStyle="rgba(0, 0, 0, .4)",e.fillRect(0,0,n,r)}function m(e){var t=new Image,n=document.createElement("canvas"),r=n.getContext("2d"),o=!1;return t.onload=function(){n.width=t.width,n.height=t.height,r.drawImage(t,0,0,t.width,t.height)},t.src=e,function(e,t){if(!o){var r=f(!0),i=r.src;o=!0,i.onload=function(){requestAnimationFrame(function(){t(),o=!1})},i.src=n.toDataURL("image/jpeg",e)}}}function v(e){var t=r();P(t),t.drawImage(e.src,0,0,e.width,e.height)}function p(e,t){e.strokeRect(t.x+.5,t.y+.5,t.width,t.height)}function w(e,t,n){var r=t.width,o=t.height,i=r&&o,a=t.x,s=t.y,u=void 0;i&&(u=e.getImageData(a,s,r,o),0>r&&(a+=r),0>o&&(s+=o)),(i||n)&&h(e),u&&e.putImageData(u,a,s),p(e,t)}function y(e,t,n){var r=t.width>0?t.width:-t.width,i=t.height>0?t.height:-t.height,a=o(),s=a.width,u=a.height;e.save(),e.translate(t.x+.5+t.width/2,t.y+.5+t.height/2),e.rotate(n),e.strokeRect(-t.width/2,-t.height/2,t.width,t.height),e.beginPath(),e.rect(-r/2,-i/2,r,i),e.restore(),e.rect(s,0,-s,u),e.fillStyle="rgba(0, 0, 0, .4)",e.fill()}function j(e,t,n,o){var i=r();v(e),i.save(),i.lineWidth=1,i.strokeStyle="#006494",i.setTransform(1,0,0,1,0,0),n?y(i,t,n):w(i,t,o),i.restore()}function I(e,t){var n=r(),o=f(),a=o.src,s=window.innerWidth-200,c=window.innerHeight-56;return E=m(e),i(s,c),P(n),new Promise(function(r){a.onload=function(){var e=t(a,s,c),o=e.width,i=e.height,d=(s-o)/2,g=(c-i)/2,l=L.setDefaultTranslation(d,g);x.width=o,x.height=i,L.resetTransform(),n.drawImage(a,0,0,o,i),u(),r({translated:l,widthRatio:a.width/o,heightRatio:a.height/i})},a.src=e})}Object.defineProperty(n,"__esModule",{value:!0});var b=document.getElementById("js-canvas"),x={original:new Image,withQuality:new Image},E=null,L=function(e){function t(){return l}function n(t){l.a=1,l.d=1,l=l.scale(t,t),e.setTransform(l.a,0,0,l.a,l.e,l.f)}function r(t,n){l=l.translate(t,n),e.translate(t,n)}function o(){r(g.x,g.y)}function i(e,t){var n=d.createSVGPoint();return n.x=e,n.y=t,n.matrixTransform(l.inverse())}function a(t,n,r,o,i,a){l.a=t,l.b=n,l.c=r,l.d=o,l.e=i,l.f=a,e.setTransform(t,n,r,o,i,a)}function s(){a(1,0,0,1,0,0),o()}function u(e,t){return g.x=e,g.y=t,g}function c(){return g}var d=document.createElementNS("http://www.w3.org/2000/svg","svg"),g={},l=d.createSVGMatrix();return{setDefaultTranslation:u,getTranslated:c,getTransform:t,scale:n,translate:r,getTransformedPoint:i,setTransform:a,resetTransform:s}}(r()),P=function(e){var t=new Image,n=void 0;return t.onload=function(){n=e.createPattern(t,"repeat")},t.src="images/pattern.png",function(e){var t=o(),r=t.width,i=t.height;e.fillStyle=n,e.save(),e.setTransform(1,0,0,1,0,0),e.fillRect(0,0,r,i),h(e),e.restore()}}(r());n.hideCanvas=c,n.transform=L,n.getCanvasDimensions=o,n.setCanvasDimensions=i,n.getImage=f,n.getMousePosition=g,n.drawInitialImage=I,n.drawImage=v,n.drawCanvas=j,n.setCursor=d,n.addEventListener=a,n.removeEventListener=s,n.getModifyQualityCb=l},{}],4:[function(e,t,n){"use strict";function r(){return u}function o(e,t,n){return t?e+="w":n&&(e+="e"),e}function i(e,t,n){var r=n.x,o=n.y,i=r+n.width,a=o+n.height;if(i>r){if(o>a)return t}else if(a>o)return t;return e}function a(e,t,n){var r=s(e,t,n);switch(r){case"nw":return i(r,"ne",n);case"ne":return i(r,"nw",n);case"sw":return i(r,"se",n);case"se":return i(r,"sw",n);default:return r}}function s(e,t,n){var r=4,i=n.x,a=n.y,s=i+n.width,c=a+n.height,d=e>=i-r&&s+r>=e||i+r>=e&&e>=s-r,g=t>=a-r&&c+r>=t||a+r>=t&&t>=c-r;if(u="",d&&g){var l=t>=a-r&&a+r>=t,f=e>=s-r&&s+r>=e,h=t>=c-r&&c+r>=t,m=e>=i-r&&i+r>=e;l?u=o("n",m,f):h?u=o("s",m,f):f?u="e":m&&(u="w")}return u}Object.defineProperty(n,"__esModule",{value:!0});var u="";n.get=r,n.getOpposite=a,n.set=s,n.reverse=i},{}],5:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t,n,r,o){if(n.save(),r){var i=t.x+t.width/2,a=t.y+t.height/2;n.translate(i,a),n.rotate(-r),n.translate(-i,-a)}return n.drawImage(e,0,0,e.width,e.height),n.restore(),n.getImageData(t.x+o.x,t.y+o.y,t.width,t.height)}function i(e,t){var n=document.createElement("canvas"),r=n.getContext("2d"),i=T.transform.getTranslated();i.x=i.x*W.get("width"),i.y=i.y*W.get("height"),n.width=e.width+2*i.x,n.height=e.height+2*i.y,r.translate(i.x,i.y);var a=o(e,t,r,U.get(),i);return n.width=a.width,n.height=a.height,r.putImageData(a,0,0),n}function a(e){return new Promise(function(t){var n=new Image;n.onload=function(){var r=F.getScaled(W.get()),o=i(n,r);M.worker.post({action:"add",image:{name:e.name.setByUser,type:e.type.slice(6),uri:o.toDataURL(e.type,K.get())}}),M.images.incStoredImageCount(),t()},n.src=e.uri})}function s(e,t){var n=e-1,r="";n>1||t?r=n+" images remaining":1===n&&(r=n+" image remaining"),document.getElementById("js-crop-remaining").textContent=r}function u(e){document.getElementById("js-crop-image-name").textContent=e}function c(e,t,n){var r=e.width,o=e.height,i=r/o;return r>t&&(r=t,o=r/i),o>n&&(o=n,r=o*i),{width:r,height:o}}function d(e,t){var n=T.transform.getTransformedPoint,r=n(e.x,e.y),o=r.x,i=r.y,a=n(e.x+e.width,e.y+e.height),s=a.x-o,u=a.y-i,c=F.set({x:o,y:i,width:s,height:u},!0);t&&(c.x=0,c.y=0),_.updateDataDisplay(c)}function g(){var e=M.images.getFirst();f(e),T.addEventListener("wheel",y),T.addEventListener("mousedown",h),T.addEventListener("mousemove",j),T.addEventListener("mouseleave",I),M.worker.init(),Z.show()}function l(){var e=T.getImage(K.useImageWithQuality()),t=U.get(),n=F.get(),r=F.getScaled(W.get()),o=F.getHasArea();T.drawCanvas(e,n,t,o),_.preview.draw(e.src,r)}function f(e,t){var n=M.images.getCount();s(n,t),u(e.name.original),_.toggleButtons(!0),_.toggleSkipButton(n),T.drawInitialImage(e.uri,c).then(function(e){F.setDefaultPos(e.translated.x,e.translated.y),W.set(e.widthRatio,e.heightRatio)})}function h(e){if(1===e.which){var t=T.getMousePosition(e),n=t.x,r=t.y,o=F.get(),i=o.width&&o.height,a=U.get(),s=V.set(n,r,o),u="select";if(e.shiftKey)G.set(T.transform.getTransformedPoint(n,r)),u="drag";else if(e.ctrlKey&&i)F.isInside(o,n,r,a)?(G.set({x:n-o.x,y:r-o.y}),u="move"):u="rotate";else if(s&&i&&!a)u="resize";else{m(),F.setProp("x",n),F.setProp("y",r);var c=F.get(!0),d=T.transform.getTransformedPoint(n,r);_.updatePointDisplay(c,d.x,d.y)}q.toggleEvent(u),requestAnimationFrame(l)}}function m(e){var t=F.reset();U.reset(),_.cropDataInputs.setValue("angle",0),_.preview.clean(),d(t,e)}function v(){Z.hide(),s(0),p(),q.toggleCursorEvents(),T.removeEventListener("wheel",y),T.removeEventListener("mousedown",h),T.removeEventListener("mousemove",j),T.removeEventListener("mouseleave",I),M.generateZip()}function p(){K.reset(),_.resetQualityAndScaleDisplay(),m(!0)}function w(e,t,n){var r=F.get(),o=T.transform;if(o.translate(e,t),o.scale(n/100),o.translate(-e,-t),r.width&&r.height)d(r);else{var i=o.getTransform(),a=i.e,s=i.f;F.setProp("x",a),F.setProp("y",s)}requestAnimationFrame(l)}function y(e){var t=T.getMousePosition(e),n=t.x,r=t.y,o=T.transform.getTransformedPoint(n,r),i=_.cropDataInputs.getValue("scale");e.deltaY>0?i*=.8:i/=.8,w(o.x,o.y,i),_.cropDataInputs.setValue("scale",Math.round(i))}function j(e){var t=T.getMousePosition(e),n=t.x,r=t.y,o=T.transform.getTransformedPoint(n,r),i=Math.floor(o.x),a=Math.floor(o.y);document.getElementById("js-crop-mouse-pos").textContent=i+", "+a}function I(){document.getElementById("js-crop-mouse-pos").textContent=""}function b(e){p(),F.setHasArea(!1),T.hideCanvas(),setTimeout(function(){f(e,!0)},240)}function x(){var e=M.images,t=e.remove(0);a(t).then(function(){e.getCount()?b(e.getFirst()):v()})}function E(){var e=F.getScaled(W.get()),t=T.getImage(K.useImageWithQuality()),n=t.src,r=i(n,e),o=r.toDataURL("image/jpeg");$.show(o)}function L(){var e=M.images;e.remove(0);var t=e.getFirst();t&&b(t)}function P(e){var t=document.getElementById("js-crop-sidebar"),n=t.classList,r=T.transform.getTransform();n.contains("hide")?(e.setAttribute("title","hide sidebar"),e.style.transform="rotateZ(0)",T.setCanvasDimensions(window.innerWidth-200)):(e.setAttribute("title","show sidebar"),e.style.transform="rotateZ(180deg)",T.setCanvasDimensions(window.innerWidth)),T.transform.setTransform(r.a,r.b,r.c,r.d,r.e,r.f),n.toggle("hide"),requestAnimationFrame(l)}function C(){var e=T.transform.getTranslated();p(),F.setDefaultPos(e.x,e.y),F.setHasArea(!1),T.transform.resetTransform(),T.drawImage(T.getImage()),_.toggleButtons(!0)}function D(e){var t=e.target,n=t.getAttribute("data-btn");switch(n){case"reset":C();break;case"close":v()}}function A(e){var t=e.target,n=t.getAttribute("data-btn");switch(n){case"crop":x();break;case"preview":E();break;case"skip":L();break;case"toggle":P(t)}}Object.defineProperty(n,"__esModule",{value:!0}),n.skipImage=n.showPreview=n.cropImage=n.resetData=n.scaleImage=n.getCroppedCanvas=n.updateTransformedArea=n.getImageSize=n.mousePosition=n.preview=n.draw=n.init=void 0;var B=e("./../dropbox.js"),M=r(B),k=e("./cropper.canvas.js"),T=r(k),O=e("./cropper.sidebar.js"),_=r(O),S=e("./cropper.canvas-events.js"),q=r(S),z=e("./cropper.selected-area.js"),F=r(z),N=e("./cropper.direction.js"),V=r(N),R=e("./cropper.ratio.js"),W=r(R),Q=e("./cropper.angle.js"),U=r(Q),H=e("./cropper.quality.js"),K=r(H),Z=function(){function e(){n.classList.add("show")}function t(){n.classList.remove("show")}var n=document.getElementById("js-crop");return{show:e,hide:t}}(),$=function(){function e(e){var t=new Image;t.onload=function(){var e=t.width,n=t.height,r=window.innerWidth-8,o=window.innerHeight-8,i=e/n;e>r&&(e=r,n=Math.floor(e/i)),n>o&&(n=o,e=Math.floor(n*i)),t.style.width=e+"px",t.style.height=n+"px"},t.src=e,r.appendChild(t),n.classList.add("show")}function t(){n.classList.remove("show"),setTimeout(function(){r.removeChild(r.lastElementChild)},600)}var n=document.getElementById("js-crop-preview"),r=n.firstElementChild;return{show:e,hide:t}}(),G=function(){function e(e){n=e}function t(){return n}var n=null;return{set:e,get:t}}();document.getElementById("js-crop-top-btns").addEventListener("click",D),document.getElementById("js-crop-bottom-btns").addEventListener("click",A),document.getElementById("js-crop-preview-close").addEventListener("click",$.hide),n.init=g,n.draw=l,n.preview=$,n.mousePosition=G,n.getImageSize=c,n.updateTransformedArea=d,n.getCroppedCanvas=i,n.scaleImage=w,n.resetData=p,n.cropImage=x,n.showPreview=E,n.skipImage=L},{"./../dropbox.js":11,"./cropper.angle.js":1,"./cropper.canvas-events.js":2,"./cropper.canvas.js":3,"./cropper.direction.js":4,"./cropper.quality.js":6,"./cropper.ratio.js":7,"./cropper.selected-area.js":8,"./cropper.sidebar.js":9}],6:[function(e,t,n){"use strict";function r(e){u=e!==s,c=e}function o(){u=!1}function i(){return u?c:s}function a(){return u}Object.defineProperty(n,"__esModule",{value:!0});var s=.92,u=!1,c=s;n.get=i,n.set=r,n.reset=o,n.useImageWithQuality=a},{}],7:[function(e,t,n){"use strict";function r(e){return e?("x"===e?e="width":"y"===e&&(e="height"),i[e]):i}function o(e,t){i.width=e,i.height=t}Object.defineProperty(n,"__esModule",{value:!0});var i={};n.get=r,n.set=o},{}],8:[function(e,t,n){"use strict";function r(e){return e?p:v}function o(e){var t=e.width,n=e.height;return{x:Math.floor(p.x*t),y:Math.floor(p.y*n),width:Math.floor(p.width*t),height:Math.floor(p.height*n)}}function i(e){return v[e]}function a(e,t){return t?(Object.assign(p,e),p):(Object.assign(v,e),v)}function s(e,t){return v[e]=t,t}function u(e,t){s("x",e),s("y",t)}function c(){return v.x=0,v.y=0,v.width=0,v.height=0,Object.assign(p,v),v}function d(e,t,n){var r=e.x,o=e.y,i=r+e.width,a=o+e.height,s=t>=r&&i>=t||r>=t&&t>=i,u=n>=o&&a>=n||o>=n&&n>=a;return s&&u}function g(e,t,n,r){var o=t-(e.x+e.width/2),i=n-(e.y+e.height/2),a=Math.sin(-r),s=Math.cos(-r),u=o*s-i*a,c=o*a+i*s,g={x:-e.width/2,y:-e.height/2,width:e.width,height:e.height};return d(g,u,c)}function l(e,t,n,r){return r?g(e,t,n,r):d(e,t,n)}function f(e,t,n,r){var o=r.a,i=0;p[e]=t||0,"x"===e?(i=r.e,v.width<0&&(v.width=-v.width)):"y"===e?(i=r.f,v.height<0&&(v.height=-v.height)):"width"===e?v[e]<0&&(v.x=v.x+v[e]):"height"===e&&v[e]<0&&(v.y=v.y+v[e]),v[e]=i+p[e]/n*o}function h(e){return w=e}function m(){return w}Object.defineProperty(n,"__esModule",{value:!0});var v={x:0,y:0,width:0,height:0},p=Object.assign({},v),w=void 0;n.get=r,n.getScaled=o,n.set=a,n.getProp=i,n.setProp=s,n.setDefaultPos=u,n.reset=c,n.isInside=l,n.update=f,n.setHasArea=h,n.getHasArea=m},{}],9:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(){var e=arguments.length<=0||void 0===arguments[0]?.92:arguments[0];document.getElementById("js-quality-value").textContent=e}function i(e,t){e.disabled=t}function a(e){var t=document.getElementById("js-crop-ok"),n=document.getElementById("js-crop-preview-btn");i(t,e),i(n,e)}function s(e){var t=document.getElementById("js-crop-skip");i(t,1>=e)}function u(e,t){return e?t>0?e:t+e:0}function c(e){var t=arguments.length<=1||void 0===arguments[1]?e.x:arguments[1],n=arguments.length<=2||void 0===arguments[2]?e.y:arguments[2],r=P.get(),o=r.width,i=r.height;e.width&&e.height&&(t=u(t,e.width),n=u(n,e.height)),k.setValue("x",Math.floor(t*o)),k.setValue("y",Math.floor(n*i))}function d(e,t){var n=P.get(),r=n.width,o=n.height;e=Math.floor(e*r),t=Math.floor(t*o),k.setValue("width",0>e?-e:e),k.setValue("height",0>t?-t:t)}function g(e){c(e),d(e.width,e.height)}function l(){k.setValue("scale",100),k.setValue("quality",.92),o()}function f(e,t){var n=e.selectionStart,r=e.selectionEnd,o=e.value;return o=n===r?o.slice(0,n)+t+o.slice(n,o.length):o.slice(0,n)+t+o.slice(r,o.length),Number.parseInt(o,10)}function h(e,t){if("scale"===e){var n=b.getCanvasDimensions(),r=n.width,o=n.height;return void j.scaleImage(r/2,o/2,t)}if("angle"===e)D.set(t,"rad");else{var i=b.transform.getTransform(),s=P.get(e);E.update(e,t,s,i)}var u=E.get(),c=u.width&&u.height;a(!c),c&&requestAnimationFrame(j.draw)}function m(e){if(e.key)return e.key;var t=e.keyCode||e.which;return t?8===t||13===t?t:String.fromCharCode(t):void 0}function v(e){var t=e.target,n=m(e),r=t.getAttribute("data-input"),o="Backspace"===n||8===n,i="Enter"===n||13===n;if(r&&/\d|-/.test(n)){var a="-"===n||45===n;if(a&&"x"!==r&&"y"!==r)return void e.preventDefault();var s=f(t,n);h(r,s)}else o||i||e.preventDefault()}function p(e){var t=m(e),n="Backspace"===t||8===t,r="Enter"===t||13===t;if(n||r){var o=e.target,i=o.getAttribute("data-input");h(i,o.value)}}function w(e){var t=Number.parseFloat(e.target.value),n=b.getModifyQualityCb();n(t,j.draw),o(t),B.set(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.resetQualityAndScaleDisplay=n.updateDataDisplay=n.updateMeasurmentDisplay=n.updatePointDisplay=n.toggleSkipButton=n.toggleButtons=n.cropDataInputs=n.preview=void 0;var y=e("./cropper.js"),j=r(y),I=e("./cropper.canvas.js"),b=r(I),x=e("./cropper.selected-area.js"),E=r(x),L=e("./cropper.ratio.js"),P=r(L),C=e("./cropper.angle.js"),D=r(C),A=e("./cropper.quality.js"),B=r(A),M=document.getElementById("js-crop-data"),k=function(){function e(e){return document.getElementById("js-crop-"+e)}function t(t){var n=e(t);return n.value}function n(t,n){var r=e(t);r.value=n}return{getValue:t,setValue:n}}(),T=function(){function e(){r.clearRect(0,0,o,i)}function t(t,n){if(!a){if(!n.width||!n.height)return void e();a=!0,requestAnimationFrame(function(){var s=j.getCroppedCanvas(t,n),u=j.getImageSize(s,o,i),c=u.width,d=u.height,g=(o-c)/2,l=(i-d)/2;e(),r.drawImage(s,g,l,c,d),a=!1})}}var n=document.getElementById("js-sidebar-preview"),r=n.getContext("2d"),o=192,i=150,a=!1;return n.width=o,n.height=i,{clean:e,draw:t}}();M.addEventListener("keypress",v),M.addEventListener("keyup",p),document.getElementById("js-crop-quality").addEventListener("input",w),n.preview=T,n.cropDataInputs=k,n.toggleButtons=a,n.toggleSkipButton=s,n.updatePointDisplay=c,n.updateMeasurmentDisplay=d,n.updateDataDisplay=g,n.resetQualityAndScaleDisplay=l},{"./cropper.angle.js":1,"./cropper.canvas.js":3,"./cropper.js":5,"./cropper.quality.js":6,"./cropper.ratio.js":7,"./cropper.selected-area.js":8}],10:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e){e.stopPropagation(),e.preventDefault()}function i(e){e.preventDefault(),1!==d.state.get()&&(l+=1,g.classList.add("over"))}function a(){1!==d.state.get()&&(l-=1,l||g.classList.remove("over"))}function s(e){return l=0,g.classList.remove("over"),e.stopPropagation(),e.preventDefault(),1===d.state.get()?void(e.dataTransfer.dropEffect="none"):(e.dataTransfer.dropEffect="copy",void d.onFiles(e.dataTransfer.files))}function u(e){1===d.state.get()&&e.preventDefault()}var c=e("./dropbox.js"),d=r(c),g=document.getElementById("js-dropbox"),l=0;g.addEventListener("dragover",o,!1),g.addEventListener("dragenter",i,!1),g.addEventListener("dragleave",a,!1),g.addEventListener("drop",s,!1),g.addEventListener("click",u,!1)},{"./dropbox.js":11}],11:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e){try{saveAs(e,"images.zip")}catch(t){var n=document.createElement("script");n.setAttribute("src","js/libs/FileSaver.min.js"),document.getElementsByTagName("body")[0].appendChild(n),n.onload=function(){saveAs(e,"images.zip")}}}function a(e){document.getElementById("js-dropbox-label").classList[e]("mask"),document.getElementById("js-mask").classList[e]("show")}function s(){B.setLabel(""),a("remove")}function u(){a("add"),C.set(1),B.show(),k.hide("process"),k.show("cancel")}function c(){var e=arguments.length<=0||void 0===arguments[0]?-1:arguments[0];C.set(e),k.hide("cancel"),B.reset(),s()}function d(){return 0!==C.get()?D.getCount()?void("cropper"===E.getCurrentTool()?(c(),P.init()):(B.reset(),b.processImages())):(c(),void M.show("No images to process")):void 0}function g(e){return e.includes("image")}function l(e){return e.slice(0,e.lastIndexOf("."))}function f(e){var t=document.getElementById("js-image-name").value||l(e),n=document.getElementById("js-image-name-seperator").value||"-";return t+n}function h(){D.getStoredImageCount()&&(D.resetStoredImageCount(),B.setLabel("Generating archive"),A.post({action:"generate"}))}function m(e){var t=new FileReader;t.readAsDataURL(e),t.onloadend=function(t){D.add({name:{original:e.name,setByUser:f(e.name)},type:e.type,size:e.size/1e6,uri:t.target.result})}}function v(e,t){var n=e.splice(0,1)[0];if(B.setLabel("Reading: "+n.name),g(n.type)&&m(n),B.update(t),!e.length)return void setTimeout(d,1200);var r=n.size/1e6*100+120;setTimeout(function(){0!==C.get()&&v(e,t)},r)}function p(){D.reset(),c(0),M.show("Work canceled")}function w(e){var t=100/e.length;A.isInited()&&A.post({action:"remove"}),D.getCount()&&D.reset(),C.set(-1),k.hide("download"),u(),v([].concat(o(e)),t)}function y(e){var t=e.target.getAttribute("data-btn");"process"===t?b.processImages():"download"===t?A.post({action:"download"}):"cancel"===t&&p()}function j(e){var t=e.target.files;e.preventDefault(),t.length&&w(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.removeMasksAndLabel=n.resetDropbox=n.generateZip=n.beforeWork=n.onFiles=n.button=n.message=n.progress=n.worker=n.images=n.state=void 0;var I=e("./resizer.js"),b=r(I),x=e("./tools.js"),E=r(x),L=e("./cropper/cropper.js"),P=r(L),C=function(){function e(){return n}function t(e){n=e}var n=-1;return{get:e,set:t}}(),D=function(){function e(){return c}function t(){return c[0]}function n(){return c.length}function r(e){return c.splice(e,1)[0]}function o(e){c.push(e)}function i(){c.length=0}function a(){d+=1}function s(){return d}function u(){d=0}var c=[],d=0;return{add:o,remove:r,getCount:n,reset:i,getAll:e,getFirst:t,incStoredImageCount:a,getStoredImageCount:s,resetStoredImageCount:u}}(),A=function(){function e(){r||(r=new Worker("js/workers/worker1.js"),r.onmessage=function(e){var t=e.data;"download"===t.action?i(t.content):"notify"===t.action&&(C.set(-1),s(),M.show("Images are ready for downloading"),k.show("download"))},r.onerror=function(e){console.log(e)})}function t(e){r.postMessage(e)}function n(){return!!r}var r=void 0;return{init:e,post:t,isInited:n}}(),B=function(){function e(){i.classList.add("show")}function t(){i.classList.remove("show")}function n(e){a.textContent=e}function r(e){i.value+=e}function o(){i.classList.remove("show"),i.value=0}var i=document.getElementById("js-progress"),a=document.getElementById("js-progress-label");return{show:e,hide:t,setLabel:n,update:r,reset:o}}(),M=function(){function e(e){r&&clearTimeout(r),r=setTimeout(t,e)}function t(){var t=arguments.length<=0||void 0===arguments[0]?"":arguments[0];n.textContent=t,t&&e(2e3)}var n=document.getElementById("js-msg"),r=0;return{show:t}}(),k=function(){function e(e,t){document.getElementById("js-"+t).classList[e]("show")}function t(t){e("add",t)}function n(t){e("remove",t)}return{show:t,hide:n}}();document.getElementById("js-dropbox-btns").addEventListener("click",y,!1),document.getElementById("js-image-select").addEventListener("change",j,!1),n.state=C,n.images=D,n.worker=A,n.progress=B,n.message=M,n.button=k,n.onFiles=w,n.beforeWork=u,n.generateZip=h,n.resetDropbox=c,n.removeMasksAndLabel=s},{"./cropper/cropper.js":5,"./resizer.js":14,"./tools.js":15}],12:[function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(){var e=[].concat(r(document.querySelectorAll(".preload")));e.forEach(function(e){e.classList.remove("preload")}),window.removeEventListener("load",o,!1)}e("./dropbox.js"),e("./dropbox.drag.js"),e("./tools.js"),window.addEventListener("load",o,!1),window.addEventListener("drop",function(e){e.preventDefault()},!1),window.addEventListener("dragover",function(e){e.preventDefault()},!1)},{"./dropbox.drag.js":10,"./dropbox.js":11,"./tools.js":15}],13:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e){var t={dimensionInputValues:e,imageName:y.value||"",imageNameSeperator:j.value||"",imageQuality:I.value};localStorage.setItem("selections",JSON.stringify(t))}function a(e){return e.reduce(function(e,t){return e.push(t.width,t.height),e},[])}function s(){for(var e=w.children,t=[],n=0,r=e.length;r>n;n+=2){var o=e[n].value,i=e[n+1].value;(o||i)&&t.push({width:o,height:i})}return u(t)}function u(e){return e.length?(e=e.filter(function(e){return c(e.width,e.height)}),e.length||(p.message.show("No valid values"),p.button.show("process"))):(p.message.show("No dimensions specified"),p.button.show("process")),e}function c(e,t){var n=/^\d+(px|%)?$|^same$|^original$|^width$|^height$/,r=n.test(e)&&!("same"===e&&(!t||"same"===t)),o=n.test(t)&&!("same"===t&&(!e||"same"===e));return r||o}function d(e,t){Array.prototype.forEach.call(e,function(e,n){e.value=t[n]})}function g(){var e=document.createElement("input");return e.setAttribute("type","text"),e.classList.add("image-input"),e}function l(e){for(var t=document.createDocumentFragment(),n=0;e>n;n++)t.appendChild(g());return t}function f(e,t){var n=e.children.length;if(t>n){var r=t-n;e.appendChild(l(r))}}function h(e){p.message.show("Image quality set to: "+e.target.value+"%")}function m(e){var t=[].concat(o(w.children)),n=t.indexOf(e.target),r=n%2===0&&!t[n+2],i=n%2!==0&&!t[n+1];(r||i)&&w.appendChild(l(2))}Object.defineProperty(n,"__esModule",{value:!0}),n.getInputValues=n.saveToLocalStorage=void 0;var v=e("./dropbox.js"),p=r(v),w=document.getElementById("js-dimension-inputs"),y=document.getElementById("js-image-name"),j=document.getElementById("js-image-name-seperator"),I=document.getElementById("js-image-quality");!function(){var e=localStorage.getItem("selections");if(e){e=JSON.parse(e);var t=a(e.dimensionInputValues);f(w,t.length),d(w.children,t),y.value=e.imageName,j.value=e.imageNameSeperator,I.value=e.imageQuality}}(),I.addEventListener("input",h,!1),w.addEventListener("focus",m,!0),n.saveToLocalStorage=i,n.getInputValues=s},{"./dropbox.js":11}],14:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e){return"width"===e?"height":"width"}function i(e,t,n){var r=o(e),i="same"===t[e]?t[r]:t[e],a=n[e];return i.includes("%")?a*(Number.parseInt(i,10)/100):"original"===i||i===e?Number.parseInt(a,10):i===r?Number.parseInt(n[r],10):Number.parseInt(i,10)}function a(e,t){var n=t.width/t.height,r=0,o=0;return e.width&&(r=i("width",e,t),e.height?"same"===e.width&&(o=r):o=r/n),!o&&e.height&&(o=i("height",e,t),e.width?r||"same"!==e.height||(r=o):r=o*n),{width:r,height:o}}function s(e,t,n){var r=n.width,o=n.height,i=document.createElement("canvas"),a=document.getElementById("js-image-quality").value/100;return i.width=r,i.height=o,i.getContext("2d").drawImage(e,0,0,r,o),i.toDataURL(t,a)}function u(){0!==f.state.get()&&(f.button.hide("cancel"),f.progress.reset(),f.generateZip())}function c(e,t,n){var r={width:e.width,height:e.height},o=n.map(function(e){return a(e,r)});return f.progress.setLabel("Processing: "+t.name.original),function i(n){var r=o.splice(0,1)[0];if(f.progress.update(n),f.worker.post({action:"add",image:{name:t.name.setByUser,uri:s(e,t.type,r),type:t.type.slice(6)}}),v.decrement(),!v.get())return void setTimeout(u,1600);if(o.length){var a=t.size*r.width*r.height/2e3+120;setTimeout(function(){0!==f.state.get()&&i(n)},a)}}}function d(e,t){var n=e.length*t.length,r=100/n;return v.set(n),function o(){var n=new Image,i=e.splice(0,1)[0];if(n.onload=function(){if(0!==f.state.get()){var e=c(n,i,t);e(r)}},n.src=i.uri,e.length){var a=400*i.size+100;setTimeout(function(){0!==f.state.get()&&o()},a)}}}function g(){var e=m.getInputValues();if(e.length){var t=f.images.getAll(),n=d(t,e);f.worker.init(),f.beforeWork(),n(),m.saveToLocalStorage(e)}else f.resetDropbox()}Object.defineProperty(n,"__esModule",{value:!0}),n.processImages=void 0;var l=e("./dropbox.js"),f=r(l),h=e("./resizer.dashboard.js"),m=r(h),v=function(){function e(e){r=e}function t(){return r}function n(){r-=1}var r=0;return{set:e,get:t,decrement:n}}();n.processImages=g},{"./dropbox.js":11,"./resizer.dashboard.js":13}],15:[function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(){return c}function i(e,t){var n=document.getElementById("js-"+e+"-settings");t.classList.toggle("active"),n&&n.classList.toggle("active")}function a(){var e=[].concat(r(document.querySelectorAll(".tool-selection-btn")));e.forEach(function(e){if(e.classList.contains("active")){var t=e.getAttribute("data-tool");i(t,e)}})}function s(e){
var t=e.target,n=t.getAttribute("data-tool");n&&n!==c&&(c=n,a(),i(n,t),u.message.show(n+" enabled"))}Object.defineProperty(n,"__esModule",{value:!0}),n.getCurrentTool=void 0;var u=e("./dropbox.js"),c="resizer";document.getElementById("js-tools-btns").addEventListener("click",s,!1),n.getCurrentTool=o},{"./dropbox.js":11}]},{},[12]);