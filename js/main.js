!function e(t,n,r){function o(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[a]={exports:{}};t[a][0].call(d.exports,function(e){var n=t[a][1][e];return o(n?n:e)},d,d.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,n){"use strict";function r(e){return e>180&&(e-=360),e*Math.PI/180}function o(e){var t=Math.round(180*e/Math.PI);return 0>t&&(t+=360),t}function i(e,t){if("rad"===t)return u=r(e);if("deg"===t){var n=o(e);return u=0===n||360===n?0:e,n}}function a(){return u}function s(){u=0}Object.defineProperty(n,"__esModule",{value:!0});var u=0;n.set=i,n.get=a,n.reset=s,n.convertRadiansToDegrees=o},{}],2:[function(e,t,n){"use strict";function r(){return g.getContext("2d")}function o(){return{width:g.width,height:g.height}}function i(e){g.width=e?window.innerWidth-200:window.innerWidth,g.height=window.innerHeight-56}function a(e,t){g.addEventListener(e,t)}function s(e,t){g.removeEventListener(e,t)}function u(){g.classList.add("show")}function c(){g.classList.remove("show")}function d(){var e=arguments.length<=0||void 0===arguments[0]?"default":arguments[0];g.style.cursor=e}function l(e){var t=e.clientX,n=e.clientY,r=g.getBoundingClientRect(),o=r.left,i=r.top;return{x:t-o,y:n-i}}Object.defineProperty(n,"__esModule",{value:!0});var g=document.getElementById("js-canvas");n.getDimensions=o,n.resetDimensions=i,n.show=u,n.hide=c,n.getContext=r,n.addEventListener=a,n.removeEventListener=s,n.setCursor=d,n.getMousePosition=l},{}],3:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e){e?(E.addEventListener("mousemove",m),window.addEventListener("keydown",v)):(E.removeEventListener("mousemove",m),window.removeEventListener("keydown",v))}function i(){var e=arguments.length<=0||void 0===arguments[0]?V:arguments[0],t=document.getElementById("js-crop"),n=e===V;n?(V="",t.removeEventListener("mousemove",a),t.removeEventListener("mouseup",s)):(V=e,t.addEventListener("mousemove",a),t.addEventListener("mouseup",s)),o(n)}function a(e){e.target!==document.getElementById("js-canvas")&&e.preventDefault();var t=E.getMousePosition(e),n=t.x,r=t.y,o=O.get();switch(V){case"select":u(o,n,r);break;case"resize":c(o,n,r);break;case"rotate":l(o,n,r);break;case"move":if(!e.ctrlKey)return;g(n,r);break;case"drag":if(!e.shiftKey)return;f(n,r)}o.width&&o.height&&"rotate"!==V&&y.updateTransformedArea(o),requestAnimationFrame(y.draw)}function s(){var e=O.get(),t=e.width&&e.height;if(i(),!t){var n=O.reset(),r=L.image.get(q.useImageWithQuality());L.drawImage(r),E.setCursor(),M.update(n)}O.containsArea(t),C.toggleButton(!t,"crop","preview")}function u(e,t,n){O.setProp("width",t-e.x),O.setProp("height",n-e.y),O.containsArea(!0)}function c(e,t,n){var r=k.get();if(-1!==r.indexOf("n")?(O.setProp("height",e.y-n+e.height),O.setProp("y",n)):-1!==r.indexOf("s")&&O.setProp("height",n-e.y),-1!==r.indexOf("w")?(O.setProp("width",e.x-t+e.width),O.setProp("x",t)):-1!==r.indexOf("e")&&O.setProp("width",t-e.x),r.length>1){var o=k.reverse(r,e);E.setCursor(o+"-resize")}}function d(e,t,n){var r=e.x+e.width/2,o=e.y+e.height/2;return Math.atan2(o-n,r-t)}function l(e,t,n){var r=d(e,t,n),o=T.set(r,"deg");M.setValue("angle",o)}function g(e,t){var n=y.mousePosition.get();O.setProp("x",e-n.x),O.setProp("y",t-n.y)}function f(e,t){var n=y.mousePosition.get();if(n){var r=E.getContext(),o=b.getTransformedPoint(e,t);b.translate(r,o.x-n.x,o.y-n.y)}}function p(){E.setCursor(),window.removeEventListener("keyup",p)}function v(e){var t=T.get(),n=O.get(),r=y.mousePosition.get(),o=r.x,i=r.y;e.ctrlKey&&O.isInside(n,o,i,t)&&E.setCursor("move"),window.addEventListener("keyup",p)}function h(e,t,n){var r=k.getReal(t,n,e),o=r?r+"-resize":"default";E.setCursor(o)}function m(e){var t=E.getMousePosition(e),n=t.x,r=t.y,o=O.get(),i=T.get();if(y.mousePosition.set({x:n,y:r}),o.width&&o.height){if(e.ctrlKey){var a="default";return O.isInside(o,n,r,i)&&(a="move"),void E.setCursor(a)}i||h(o,n,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.toggleCursorEvents=n.toggleEvent=void 0;var w=e("./cropper.js"),y=r(w),j=e("./cropper.canvas-transform.js"),b=r(j),x=e("./cropper.canvas-element.js"),E=r(x),I=e("./cropper.canvas.js"),L=r(I),P=e("./cropper.sidebar.js"),C=r(P),_=e("./cropper.data-input.js"),M=r(_),A=e("./cropper.selected-area.js"),O=r(A),B=e("./cropper.direction.js"),k=r(B),D=e("./cropper.angle.js"),T=r(D),S=e("./cropper.quality.js"),q=r(S),V="";n.toggleEvent=i,n.toggleCursorEvents=o},{"./cropper.angle.js":1,"./cropper.canvas-element.js":2,"./cropper.canvas-transform.js":4,"./cropper.canvas.js":5,"./cropper.data-input.js":6,"./cropper.direction.js":7,"./cropper.js":8,"./cropper.quality.js":9,"./cropper.selected-area.js":10,"./cropper.sidebar.js":11}],4:[function(e,t,n){"use strict";function r(){return p}function o(e,t){p.a=1,p.d=1,p=p.scale(t,t),e.setTransform(p.a,0,0,p.a,p.e,p.f)}function i(e,t,n){p=p.translate(t,n),e.translate(t,n)}function a(e){i(e,f.x,f.y)}function s(e,t){var n=g.createSVGPoint();return n.x=e,n.y=t,n.matrixTransform(p.inverse())}function u(e,t,n,r,o,i,a){p.a=t,p.b=n,p.c=r,p.d=o,p.e=i,p.f=a,e.setTransform(t,n,r,o,i,a)}function c(e){u(e,1,0,0,1,0,0),a(e)}function d(e,t){return f.x=e,f.y=t,f}function l(){return f}Object.defineProperty(n,"__esModule",{value:!0});var g=document.createElementNS("http://www.w3.org/2000/svg","svg"),f={},p=g.createSVGMatrix();n.get=r,n.set=u,n.reset=c,n.setDefaultTranslation=d,n.getTranslated=l,n.scale=o,n.translate=i,n.getTransformedPoint=s},{}],5:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e){var t=v.getDimensions(),n=t.width,r=t.height;e.fillStyle="rgba(0, 0, 0, .4)",e.fillRect(0,0,n,r)}function i(e){var t=v.getContext();w(t),t.drawImage(e,0,0,e.width,e.height)}function a(e,t){e.strokeRect(t.x+.5,t.y+.5,t.width,t.height)}function s(e,t,n){var r=t.width,i=t.height,s=r&&i,u=t.x,c=t.y,d=void 0;s&&(d=e.getImageData(u,c,r,i),0>r&&(u+=r),0>i&&(c+=i)),(s||n)&&o(e),d&&e.putImageData(d,u,c),a(e,t)}function u(e,t,n){var r=t.width>0?t.width:-t.width,o=t.height>0?t.height:-t.height,i=v.getDimensions(),a=i.width,s=i.height;e.save(),e.translate(t.x+.5+t.width/2,t.y+.5+t.height/2),e.rotate(n),e.strokeRect(-t.width/2,-t.height/2,t.width,t.height),e.beginPath(),e.rect(-r/2,-o/2,r,o),e.restore(),e.rect(a,0,-a,s),e.fillStyle="rgba(0, 0, 0, .4)",e.fill()}function c(e,t,n,r){var o=v.getContext();i(e),o.save(),o.lineWidth=1,o.strokeStyle="#006494",o.setTransform(1,0,0,1,0,0),n?u(o,t,n):s(o,t,r),o.restore()}function d(e,t){var n=h.get();return m.draw(e),new Promise(function(r){n.onload=function(){t(n),v.show(),r()},n.src=e})}function l(e,t,n,r){var o=(n-e)/2,i=(r-t)/2;return f.setDefaultTranslation(o,i)}Object.defineProperty(n,"__esModule",{value:!0}),n.spareCanvas=n.setDefaultImagePosition=n.removeEventListener=n.addEventListener=n.drawCanvas=n.drawImage=n.drawInitialImage=n.image=void 0;var g=e("./cropper.canvas-transform.js"),f=r(g),p=e("./cropper.canvas-element.js"),v=r(p),h=function(){function e(e){return e?n:t}var t=new Image,n=new Image;return{get:e}}(),m=function(e){function t(e){var t=new Image;t.onload=function(){r.width=t.width,r.height=t.height,o.drawImage(t,0,0,t.width,t.height)},t.src=e}function n(t,n){if(!i){var o=e.get(!0);i=!0,o.onload=function(){requestAnimationFrame(function(){n(),i=!1})},o.src=r.toDataURL("image/jpeg",t)}}var r=document.createElement("canvas"),o=r.getContext("2d"),i=!1;return{draw:t,adjustQuality:n}}(h),w=function(e){var t=new Image,n=void 0;return t.onload=function(){n=e.createPattern(t,"repeat")},t.src="images/pattern.png",function(e){var t=v.getDimensions(),r=t.width,i=t.height;e.fillStyle=n,e.save(),e.setTransform(1,0,0,1,0,0),e.fillRect(0,0,r,i),o(e),e.restore()}}(v.getContext());n.image=h,n.drawInitialImage=d,n.drawImage=i,n.drawCanvas=c,n.addEventListener=addEventListener,n.removeEventListener=removeEventListener,n.setDefaultImagePosition=l,n.spareCanvas=m},{"./cropper.canvas-element.js":2,"./cropper.canvas-transform.js":4}],6:[function(e,t,n){"use strict";function r(e){return document.getElementById("js-crop-"+e)}function o(e){var t=r(e);return t.value}function i(e,t){var n=r(e);"string"==typeof n.value?n.value=t:n.textContent=t}function a(e,t){return e?t>0?e:t+e:0}function s(e){var t=a(e.x,e.width),n=a(e.y,e.height);i("x",Math.floor(t)),i("y",Math.floor(n))}function u(e,t){e=Math.floor(e),t=Math.floor(t),i("width",0>e?-e:e),i("height",0>t?-t:t)}function c(e){s(e),u(e.width,e.height)}Object.defineProperty(n,"__esModule",{value:!0}),n.getValue=o,n.setValue=i,n.update=c},{}],7:[function(e,t,n){"use strict";function r(){return u}function o(e,t,n){return t?e+="w":n&&(e+="e"),e}function i(e,t){var n=t.x,r=t.y,o=n+t.width,i=r+t.height;return o>n&&r>i||n>o&&i>r?"w"===e[1]?e[0]+"e":e[0]+"w":e}function a(e,t,n){var r=s(e,t,n);return r.length<2?r:i(r,n)}function s(e,t,n){var r=4,i=n.x,a=n.y,s=i+n.width,c=a+n.height,d=e>=i-r&&s+r>=e||i+r>=e&&e>=s-r,l=t>=a-r&&c+r>=t||a+r>=t&&t>=c-r;if(u="",d&&l){var g=t>=a-r&&a+r>=t,f=e>=s-r&&s+r>=e,p=t>=c-r&&c+r>=t,v=e>=i-r&&i+r>=e;g?u=o("n",v,f):p?u=o("s",v,f):f?u="e":v&&(u="w")}return u}Object.defineProperty(n,"__esModule",{value:!0});var u="";n.get=r,n.getReal=a,n.set=s,n.reverse=i},{}],8:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t,n,r,o){if(n.save(),r){var i=t.x+t.width/2,a=t.y+t.height/2;n.translate(i,a),n.rotate(-r),n.translate(-i,-a)}return n.drawImage(e,0,0,e.width,e.height),n.restore(),n.getImageData(t.x+o.x,t.y+o.y,t.width,t.height)}function i(e,t){var n=document.createElement("canvas"),r=n.getContext("2d"),i=V.getTranslated();n.width=e.width+2*i.x,n.height=e.height+2*i.y,r.translate(i.x,i.y);var a=o(e,t,r,ee.get(),i);return n.width=a.width,n.height=a.height,r.putImageData(a,0,0),n}function a(e){return new Promise(function(t){var n=new Image;n.onload=function(){var r=H.get(!0),o=i(n,r);B.post({action:"add",image:{name:e.name.setByUser,type:e.type.slice(6),uri:o.toDataURL(e.type,ne.get())}}),S.incStoredImageCount(),t()},n.src=e.uri})}function s(e,t){var n=e-1,r="";n>1||t?r=n+" images remaining":1===n&&(r=n+" image remaining"),document.getElementById("js-crop-remaining").textContent=r}function u(e){document.getElementById("js-crop-image-name").textContent=e}function c(e,t){var n=V.getTransformedPoint(e.x,e.y),r=n.x,o=n.y,i=V.getTransformedPoint(e.x+e.width,e.y+e.height),a=i.x-r,s=i.y-o,u=H.set({x:r,y:o,width:a,height:s},!0);t&&(u.x=0,u.y=0),K.update(u)}function d(){var e=S.getFirst();N.resetDimensions(U.isVisible()),g(e),N.addEventListener("wheel",w),N.addEventListener("mousedown",f),N.addEventListener("mousemove",y),N.addEventListener("mouseleave",j),ae.enable(),B.init(),re.show()}function l(){var e=z.image.get(ne.useImageWithQuality()),t=ee.get(),n=H.get(),r=H.isDrawn();if(z.drawCanvas(e,n,t,r),U.isVisible()){var o=H.get(!0);U.preview.draw(e,o)}}function g(e,t){var n=S.getCount();s(n,t),u(e.name.original),U.toggleButton(!0,"crop","preview"),U.toggleButton(1>=n,"skip"),z.drawInitialImage(e.uri,C).then(function(){var e=V.getTranslated();H.setDefaultPos(e.x,e.y)})}function f(e){if(1===e.which){var t=N.getMousePosition(e),n=t.x,r=t.y,o=H.get(),i=o.width&&o.height,a=ee.get(),s=Y.set(n,r,o),u="select";if(e.shiftKey)ie.set(V.getTransformedPoint(n,r)),u="drag";else if(e.ctrlKey&&i)H.isInside(o,n,r,a)?(ie.set({x:n-o.x,y:r-o.y}),u="move"):u="rotate";else if(s&&i&&!a)u="resize";else{p(),H.setProp("x",n),H.setProp("y",r);var c=V.getTransformedPoint(n,r);K.update({x:c.x,y:c.y,width:0,height:0})}$.toggleEvent(u),requestAnimationFrame(l)}}function p(){H.reset(),ee.reset(),K.setValue("angle",0),U.preview.clean()}function v(){re.hide(),s(0),h(),H.containsArea(!1),$.toggleCursorEvents(),N.removeEventListener("wheel",w),N.removeEventListener("mousedown",f),N.removeEventListener("mousemove",y),N.removeEventListener("mouseleave",j),ae.disable(),D.generateZip()}function h(){ne.reset(),K.setValue("scale",100),K.setValue("quality",.92),K.setValue("quality-display",.92),p(),c(H.get(),!0)}function m(e,t,n){var r=N.getContext(),o=H.get();if(V.translate(r,e,t),V.scale(r,n/100),V.translate(r,-e,-t),o.width&&o.height)c(o);else{var i=V.get(),a=i.e,s=i.f;H.setProp("x",a),H.setProp("y",s)}requestAnimationFrame(l)}function w(e){var t=N.getMousePosition(e),n=t.x,r=t.y,o=V.getTransformedPoint(n,r),i=K.getValue("scale");e.deltaY>0?i*=.8:i/=.8,m(o.x,o.y,i),K.setValue("scale",Math.round(i))}function y(e){var t=N.getMousePosition(e),n=t.x,r=t.y,o=V.getTransformedPoint(n,r),i=Math.floor(o.x),a=Math.floor(o.y);document.getElementById("js-crop-mouse-pos").textContent=i+", "+a}function j(){document.getElementById("js-crop-mouse-pos").textContent=""}function b(e){h(),H.containsArea(!1),N.hide(),setTimeout(function(){g(e,!0)},240)}function x(){var e=S.remove(0);a(e).then(function(){S.getCount()?b(S.getFirst()):v()})}function E(){var e=H.get(!0),t=z.image.get(ne.useImageWithQuality()),n=i(t,e),r=n.toDataURL("image/jpeg");oe.show(r)}function I(){S.remove(0);var e=S.getFirst();e&&b(e)}function L(e){var t=N.getContext(),n=V.get();N.resetDimensions(e),V.set(t,n.a,n.b,n.c,n.d,n.e,n.f)}function P(e,t,n,r){function o(e,t,n){var r=t-n;return e-100/(t/r)}var i=100;return e>n&&(i=o(i,e,n),t*i/100>r&&(i=o(100,t,r))),i}function C(e){var t=N.getContext(),n=N.getDimensions(),r=n.width,o=n.height,i=e.width,a=e.height,s=100;s=i>a?P(i,a,r,o):P(a,i,o,r),z.setDefaultImagePosition(i*s/100,a*s/100,r,o),V.reset(t),m(0,0,s),K.setValue("scale",Math.round(s)),z.drawImage(e)}function _(){var e=V.getTranslated();h(),H.setDefaultPos(e.x,e.y),H.containsArea(!1),C(z.image.get()),U.toggleButton(!0,"crop","preview")}function M(e){var t=e.target,n=t.getAttribute("data-btn");switch(n){case"reset":_();break;case"close":v()}}function A(e){var t=e.target,n=t.getAttribute("data-btn");switch(n){case"crop":x();break;case"preview":E();break;case"skip":I();break;case"toggle":U.toggle(t)}}Object.defineProperty(n,"__esModule",{value:!0}),n.resetCanvasProperties=n.scaleImage=n.getCroppedCanvas=n.updateTransformedArea=n.mousePosition=n.draw=n.init=void 0;var O=e("./../editor.worker.js"),B=r(O),k=e("./../dropbox/dropbox.js"),D=r(k),T=e("./../dropbox/dropbox.images.js"),S=r(T),q=e("./cropper.canvas-transform.js"),V=r(q),F=e("./cropper.canvas-element.js"),N=r(F),R=e("./cropper.canvas.js"),z=r(R),W=e("./cropper.sidebar.js"),U=r(W),Q=e("./cropper.data-input.js"),K=r(Q),Z=e("./cropper.canvas-events.js"),$=r(Z),G=e("./cropper.selected-area.js"),H=r(G),J=e("./cropper.direction.js"),Y=r(J),X=e("./cropper.angle.js"),ee=r(X),te=e("./cropper.quality.js"),ne=r(te),re=function(){function e(){n.classList.add("show")}function t(){n.classList.remove("show")}var n=document.getElementById("js-crop");return{show:e,hide:t}}(),oe=function(){function e(e){var t=new Image;t.onload=function(){var e=t.width,n=t.height,r=window.innerWidth-8,o=window.innerHeight-8,i=e/n;e>r&&(e=r,n=Math.floor(e/i)),n>o&&(n=o,e=Math.floor(n*i)),t.style.width=e+"px",t.style.height=n+"px"},t.src=e,r.appendChild(t),n.classList.add("show")}function t(){n.classList.remove("show"),setTimeout(function(){r.removeChild(r.lastElementChild)},600)}var n=document.getElementById("js-crop-preview"),r=n.firstElementChild;return{show:e,hide:t}}(),ie=function(){function e(e){n=e}function t(){return n}var n=null;return{set:e,get:t}}(),ae=function(){function e(){r||(r=!0,requestAnimationFrame(function(){L(U.isVisible()),l(),r=!1}))}function t(){window.addEventListener("resize",e)}function n(){window.removeEventListener("resize",e)}var r=!1;return{enable:t,disable:n}}();document.getElementById("js-crop-top-btns").addEventListener("click",M),document.getElementById("js-crop-bottom-btns").addEventListener("click",A),document.getElementById("js-crop-preview-close").addEventListener("click",oe.hide),n.init=d,n.draw=l,n.mousePosition=ie,n.updateTransformedArea=c,n.getCroppedCanvas=i,n.scaleImage=m,n.resetCanvasProperties=L},{"./../dropbox/dropbox.images.js":14,"./../dropbox/dropbox.js":15,"./../editor.worker.js":19,"./cropper.angle.js":1,"./cropper.canvas-element.js":2,"./cropper.canvas-events.js":3,"./cropper.canvas-transform.js":4,"./cropper.canvas.js":5,"./cropper.data-input.js":6,"./cropper.direction.js":7,"./cropper.quality.js":9,"./cropper.selected-area.js":10,"./cropper.sidebar.js":11}],9:[function(e,t,n){"use strict";function r(e){u=s>e,c=e}function o(){u=!1}function i(){return u?c:s}function a(){return u}Object.defineProperty(n,"__esModule",{value:!0});var s=.92,u=!1,c=s;n.get=i,n.set=r,n.reset=o,n.useImageWithQuality=a},{}],10:[function(e,t,n){"use strict";function r(e){return e?h:v}function o(e){return v[e]}function i(e,t){return t?(Object.assign(h,e),h):(Object.assign(v,e),v)}function a(e,t){return v[e]=t,t}function s(e,t){a("x",e),a("y",t)}function u(){return v.x=0,v.y=0,v.width=0,v.height=0,Object.assign(h,v),v}function c(e,t,n){var r=e.x,o=e.y,i=r+e.width,a=o+e.height,s=t>=r&&i>=t||r>=t&&t>=i,u=n>=o&&a>=n||o>=n&&n>=a;return s&&u}function d(e,t,n,r){var o=t-(e.x+e.width/2),i=n-(e.y+e.height/2),a=Math.sin(-r),s=Math.cos(-r),u=o*s-i*a,d=o*a+i*s,l={x:-e.width/2,y:-e.height/2,width:e.width,height:e.height};return c(l,u,d)}function l(e,t,n,r){return r?d(e,t,n,r):c(e,t,n)}function g(e,t,n){var r=n.a,o=0;h[e]=t||0,"x"===e?(o=n.e,v.width<0&&(v.width=-v.width)):"y"===e?(o=n.f,v.height<0&&(v.height=-v.height)):"width"===e?v[e]<0&&(v.x=v.x+v[e]):"height"===e&&v[e]<0&&(v.y=v.y+v[e]),v[e]=o+h[e]*r}function f(e){return m=e,e}function p(){return m}Object.defineProperty(n,"__esModule",{value:!0});var v={x:0,y:0,width:0,height:0},h=Object.assign({},v),m=!1;n.get=r,n.set=i,n.getProp=o,n.setProp=a,n.reset=u,n.isInside=l,n.update=g,n.setDefaultPos=s,n.containsArea=f,n.isDrawn=p},{}],11:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;t>r;r++)n[r-1]=arguments[r];n.forEach(function(t){document.getElementById("js-cropper-"+t).disabled=e})}function i(){return A}function a(e,t){var n=e.selectionStart,r=e.selectionEnd,o=e.value;return o=n===r?o.slice(0,n)+t+o.slice(n,o.length):o.slice(0,n)+t+o.slice(r,o.length),Number.parseInt(o,10)}function s(e,t){if("scale"===e){var n=w.getDimensions(),r=n.width,i=n.height;return void p.scaleImage(r/2,i/2,t)}"angle"===e?P.set(t,"rad"):I.update(e,t,h.get());var a=I.get(),s=a.width&&a.height;o(!s,"crop","preview"),s&&requestAnimationFrame(p.draw)}function u(e){if(e.key)return e.key;var t=e.keyCode||e.which;return t?8===t||13===t?t:String.fromCharCode(t):void 0}function c(e){var t=e.target,n=u(e),r=t.getAttribute("data-input"),o="Backspace"===n||8===n,i="Enter"===n||13===n;if(r&&/\d|-/.test(n)){var c="-"===n||45===n;if(c&&"x"!==r&&"y"!==r)return void e.preventDefault();var d=a(t,n);s(r,d)}else o||i||e.preventDefault()}function d(e){var t=u(e),n="Backspace"===t||8===t,r="Enter"===t||13===t;if(n||r){var o=e.target,i=o.getAttribute("data-input");s(i,o.value)}}function l(e){var t=Number.parseFloat(e.target.value);j.spareCanvas.adjustQuality(t,p.draw),x.setValue("quality-display",t),_.set(t)}function g(e){var t=document.getElementById("js-crop-sidebar"),n=t.classList;A=!A,p.resetCanvasProperties(A),requestAnimationFrame(p.draw),n.contains("hide")?(e.setAttribute("title","Hide sidebar"),e.style.transform="rotateZ(0)"):(e.setAttribute("title","Show sidebar"),e.style.transform="rotateZ(180deg)"),n.toggle("hide")}Object.defineProperty(n,"__esModule",{value:!0}),n.toggleButton=n.preview=n.isVisible=n.toggle=void 0;var f=e("./cropper.js"),p=r(f),v=e("./cropper.canvas-transform.js"),h=r(v),m=e("./cropper.canvas-element.js"),w=r(m),y=e("./cropper.canvas.js"),j=r(y),b=e("./cropper.data-input.js"),x=r(b),E=e("./cropper.selected-area.js"),I=r(E),L=e("./cropper.angle.js"),P=r(L),C=e("./cropper.quality.js"),_=r(C),M=document.getElementById("js-crop-data"),A=!0,O=function(e){function t(e,t,n){var r=e.width,o=e.height,i=r/o;return r>=o&&(r=t,o=r/i),(o>r||o>n)&&(o=n,r=o*i),{width:r,height:o}}function n(){i.clearRect(0,0,a,s)}function r(r,o){if(!u){if(!o.width||!o.height)return void n();u=!0,requestAnimationFrame(function(){var c=e.getCroppedCanvas(r,o),d=t(c,a,s),l=d.width,g=d.height,f=(a-l)/2,p=(s-g)/2;n(),i.drawImage(c,f,p,l,g),u=!1})}}var o=document.getElementById("js-sidebar-preview"),i=o.getContext("2d"),a=192,s=150,u=!1;return o.width=a,o.height=s,{clean:n,draw:r}}(p);M.addEventListener("keypress",c),M.addEventListener("keyup",d),document.getElementById("js-crop-quality").addEventListener("input",l),n.toggle=g,n.isVisible=i,n.preview=O,n.toggleButton=o},{"./cropper.angle.js":1,"./cropper.canvas-element.js":2,"./cropper.canvas-transform.js":4,"./cropper.canvas.js":5,"./cropper.data-input.js":6,"./cropper.js":8,"./cropper.quality.js":9,"./cropper.selected-area.js":10}],12:[function(e,t,n){"use strict";function r(e,t){document.getElementById("js-"+t).classList[e]("show")}function o(e){r("add",e)}function i(e){r("remove",e)}Object.defineProperty(n,"__esModule",{value:!0}),n.show=o,n.hide=i},{}],13:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e){e.stopPropagation(),e.preventDefault()}function i(e){e.preventDefault(),1!==d.get()&&(p+=1,f.classList.add("over"))}function a(){1!==d.get()&&(p-=1,p||f.classList.remove("over"))}function s(e){return p=0,f.classList.remove("over"),e.stopPropagation(),e.preventDefault(),1===d.get()?void(e.dataTransfer.dropEffect="none"):(e.dataTransfer.dropEffect="copy",void g.onFiles(e.dataTransfer.files))}function u(e){1===d.get()&&e.preventDefault()}var c=e("./../editor.state.js"),d=r(c),l=e("./dropbox.js"),g=r(l),f=document.getElementById("js-dropbox"),p=0;f.addEventListener("dragover",o,!1),f.addEventListener("dragenter",i,!1),f.addEventListener("dragleave",a,!1),f.addEventListener("drop",s,!1),f.addEventListener("click",u,!1)},{"./../editor.state.js":18,"./dropbox.js":15}],14:[function(e,t,n){"use strict";function r(){return g}function o(){return g[0]}function i(){return g.length}function a(e){return g.splice(e,1)[0]}function s(e){g.push(e)}function u(){g.length=0}function c(){f+=1}function d(){return f}function l(){f=0}Object.defineProperty(n,"__esModule",{value:!0});var g=[],f=0;n.add=s,n.remove=a,n.getCount=i,n.reset=u,n.getAll=r,n.getFirst=o,n.incStoredImageCount=c,n.getStoredImageCount=d,n.resetStoredImageCount=l},{}],15:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e){document.getElementById("js-dropbox-label").classList[e]("mask"),document.getElementById("js-mask").classList[e]("show")}function a(){_.setLabel(""),i("remove")}function s(){i("add"),x.set(1),_.show(),B.hide("process"),B.show("cancel")}function u(){var e=arguments.length<=0||void 0===arguments[0]?-1:arguments[0];x.set(e),B.hide("cancel"),_.reset(),a()}function c(){"cropper"===S.getCurrentTool()?(u(),V.init()):(_.reset(),D.processImages())}function d(e){return e.slice(0,e.lastIndexOf("."))}function l(e){var t=document.getElementById("js-image-name").value||d(e),n=document.getElementById("js-image-name-seperator").value||"-";return t+n}function g(){P.getStoredImageCount()&&(P.resetStoredImageCount(),_.setLabel("Generating archive"),I.post({action:"generate"}))}function f(e){return new Promise(function(t){var n=new FileReader;n.readAsDataURL(e),n.onloadend=function(n){P.add({name:{original:e.name,setByUser:l(e.name)},type:e.type,size:e.size/1e6,uri:n.target.result}),t()}})}function p(e,t){var n=e.splice(0,1)[0];_.setLabel("Reading: "+n.name),_.update(t),f(n).then(function(){if(0!==x.get()){if(!e.length)return void setTimeout(c,1e3);p(e,t)}})}function v(){P.reset(),u(0),A.show("Work canceled")}function h(e){return e.filter(function(e){return e.type.includes("image")})}function m(e){var t=h(e);if(t.length){var n=100/t.length;return void p(t,n)}A.show("No images to process"),u()}function w(e){I.isInited()&&I.post({action:"remove"}),P.getCount()&&P.reset(),x.set(-1),B.hide("download"),s(),m([].concat(o(e)))}function y(e){var t=e.target.getAttribute("data-btn");"process"===t?D.processImages():"download"===t?I.post({action:"download"}):"cancel"===t&&v()}function j(e){var t=e.target.files;e.preventDefault(),t.length&&w(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.removeMasksAndLabel=n.resetDropbox=n.generateZip=n.beforeWork=n.onFiles=void 0;var b=e("./../editor.state.js"),x=r(b),E=e("./../editor.worker.js"),I=r(E),L=e("./dropbox.images.js"),P=r(L),C=e("./dropbox.progress.js"),_=r(C),M=e("./dropbox.message.js"),A=r(M),O=e("./dropbox.buttons.js"),B=r(O),k=e("./../resizer.js"),D=r(k),T=e("./../tools.js"),S=r(T),q=e("./../cropper/cropper.js"),V=r(q);document.getElementById("js-dropbox-btns").addEventListener("click",y,!1),document.getElementById("js-image-select").addEventListener("change",j,!1),n.onFiles=w,n.beforeWork=s,n.generateZip=g,n.resetDropbox=u,n.removeMasksAndLabel=a},{"./../cropper/cropper.js":8,"./../editor.state.js":18,"./../editor.worker.js":19,"./../resizer.js":22,"./../tools.js":23,"./dropbox.buttons.js":12,"./dropbox.images.js":14,"./dropbox.message.js":16,"./dropbox.progress.js":17}],16:[function(e,t,n){"use strict";function r(e){a&&clearTimeout(a),a=setTimeout(o,e)}function o(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0];i.textContent=e,e&&r(2e3)}Object.defineProperty(n,"__esModule",{value:!0});var i=document.getElementById("js-msg"),a=0;n.show=o},{}],17:[function(e,t,n){"use strict";function r(){u.classList.add("show")}function o(){u.classList.remove("show")}function i(e){c.textContent=e}function a(e){u.value+=e}function s(){u.classList.remove("show"),u.value=0}Object.defineProperty(n,"__esModule",{value:!0});var u=document.getElementById("js-progress"),c=document.getElementById("js-progress-label");n.show=r,n.hide=o,n.setLabel=i,n.update=a,n.reset=s},{}],18:[function(e,t,n){"use strict";function r(){return i}function o(e){i=e}Object.defineProperty(n,"__esModule",{value:!0});var i=-1;n.get=r,n.set=o},{}],19:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e){try{saveAs(e,"images.zip")}catch(t){var n=document.createElement("script");n.setAttribute("src","js/libs/FileSaver.min.js"),document.getElementsByTagName("body")[0].appendChild(n),n.onload=function(){saveAs(e,"images.zip")}}}function i(){v||(v=new Worker("js/workers/worker1.js"),v.onmessage=function(e){var t=e.data;"download"===t.action?o(t.content):"notify"===t.action&&(c.set(-1),(0,d.removeMasksAndLabel)(),g.show("Images are ready for downloading"),p.show("download"))},v.onerror=function(e){console.log(e)})}function a(e){v.postMessage(e)}function s(){return!!v}Object.defineProperty(n,"__esModule",{value:!0}),n.isInited=n.post=n.init=void 0;var u=e("./editor.state.js"),c=r(u),d=e("./dropbox/dropbox.js"),l=e("./dropbox/dropbox.message.js"),g=r(l),f=e("./dropbox/dropbox.buttons.js"),p=r(f),v=void 0;n.init=i,n.post=a,n.isInited=s},{"./dropbox/dropbox.buttons.js":12,"./dropbox/dropbox.js":15,"./dropbox/dropbox.message.js":16,"./editor.state.js":18}],20:[function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(){var e=[].concat(r(document.querySelectorAll(".preload")));e.forEach(function(e){e.classList.remove("preload")}),window.removeEventListener("load",o,!1)}e("./dropbox/dropbox.js"),e("./dropbox/dropbox.drag.js"),e("./tools.js"),window.addEventListener("load",o,!1),window.addEventListener("drop",function(e){e.preventDefault()},!1),window.addEventListener("dragover",function(e){e.preventDefault()},!1)},{"./dropbox/dropbox.drag.js":13,"./dropbox/dropbox.js":15,"./tools.js":23}],21:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e){var t={dimensionInputValues:e,imageName:b.value||"",imageNameSeperator:x.value||"",imageQuality:E.value};localStorage.setItem("selections",JSON.stringify(t))}function a(e){return e.reduce(function(e,t){return e.push(t.width,t.height),e},[])}function s(){for(var e=j.children,t=[],n=0,r=e.length;r>n;n+=2){var o=e[n].value,i=e[n+1].value;(o||i)&&t.push({width:o,height:i})}return u(t)}function u(e){return e.length?(e=e.filter(function(e){return c(e.width,e.height)}),e.length||(m.show("No valid values"),y.show("process"))):(m.show("No dimensions specified"),y.show("process")),e}function c(e,t){var n=/^\d+(px|%)?$|^same$|^original$|^width$|^height$/,r=n.test(e)&&!("same"===e&&(!t||"same"===t)),o=n.test(t)&&!("same"===t&&(!e||"same"===e));return r||o}function d(e,t){Array.prototype.forEach.call(e,function(e,n){e.value=t[n]})}function l(){var e=document.createElement("input");return e.setAttribute("type","text"),e.classList.add("image-input"),e}function g(e){for(var t=document.createDocumentFragment(),n=0;e>n;n++)t.appendChild(l());return t}function f(e,t){var n=e.children.length;if(t>n){var r=t-n;e.appendChild(g(r))}}function p(e){m.show("Image quality set to: "+e.target.value+"%")}function v(e){var t=[].concat(o(j.children)),n=t.indexOf(e.target),r=n%2===0&&!t[n+2],i=n%2!==0&&!t[n+1];(r||i)&&j.appendChild(g(2))}Object.defineProperty(n,"__esModule",{value:!0}),n.getInputValues=n.saveToLocalStorage=void 0;var h=e("./dropbox/dropbox.message.js"),m=r(h),w=e("./dropbox/dropbox.buttons.js"),y=r(w),j=document.getElementById("js-dimension-inputs"),b=document.getElementById("js-image-name"),x=document.getElementById("js-image-name-seperator"),E=document.getElementById("js-image-quality");!function(){var e=localStorage.getItem("selections");if(e){e=JSON.parse(e);var t=a(e.dimensionInputValues);f(j,t.length),d(j.children,t),b.value=e.imageName,x.value=e.imageNameSeperator,E.value=e.imageQuality}}(),E.addEventListener("input",p,!1),j.addEventListener("focus",v,!0),n.saveToLocalStorage=i,n.getInputValues=s},{"./dropbox/dropbox.buttons.js":12,"./dropbox/dropbox.message.js":16}],22:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e){return"width"===e?"height":"width"}function i(e,t,n){var r=o(e),i="same"===t[e]?t[r]:t[e],a=n[e];return i.includes("%")?a*(Number.parseInt(i,10)/100):"original"===i||i===e?Number.parseInt(a,10):i===r?Number.parseInt(n[r],10):Number.parseInt(i,10)}function a(e,t){var n=t.width/t.height,r=0,o=0;return e.width&&(r=i("width",e,t),e.height?"same"===e.width&&(o=r):o=r/n),!o&&e.height&&(o=i("height",e,t),e.width?r||"same"!==e.height||(r=o):r=o*n),{width:r,height:o}}function s(e,t){return e.map(function(e){return a(e,t)})}function u(e,t,n){var r=n.width,o=n.height,i=document.createElement("canvas"),a=document.getElementById("js-image-quality").value/100;return i.width=r,i.height=o,i.getContext("2d").drawImage(e,0,0,r,o),i.toDataURL(t,a)}function c(){L.hide("cancel"),
E.reset(),E.setLabel(""),y.generateZip()}function d(e,t,n){return new Promise(function(r){m.post({action:"add",image:{name:t.name.setByUser,uri:u(e,t.type,n),type:t.type.slice(6)}}),r()})}function l(e,t,n,r){var o=n.splice(0,1)[0];return d(e,t,o).then(function(){E.update(r),b.incStoredImageCount(),0!==v.get()&&n.length&&l(e,t,n,r)})}function g(e,t,n){var r=new Image,o=e.splice(0,1)[0];r.onload=function(){if(0!==v.get()){var i={width:r.width,height:r.height},a=s(t,i);E.setLabel("Processing: "+o.name.original),l(r,o,a,n).then(function(){if(0!==v.get()){if(!e.length)return void setTimeout(c,1e3);g(e,t,n)}})}},r.src=o.uri}function f(){var e=C.getInputValues();if(!e.length)return void y.resetDropbox();var t=b.getAll(),n=t.length*e.length,r=100/n;m.init(),y.beforeWork(),g(t,e,r),C.saveToLocalStorage(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.processImages=void 0;var p=e("./editor.state.js"),v=r(p),h=e("./editor.worker.js"),m=r(h),w=e("./dropbox/dropbox.js"),y=r(w),j=e("./dropbox/dropbox.images.js"),b=r(j),x=e("./dropbox/dropbox.progress.js"),E=r(x),I=e("./dropbox/dropbox.buttons.js"),L=r(I),P=e("./resizer.dashboard.js"),C=r(P);n.processImages=f},{"./dropbox/dropbox.buttons.js":12,"./dropbox/dropbox.images.js":14,"./dropbox/dropbox.js":15,"./dropbox/dropbox.progress.js":17,"./editor.state.js":18,"./editor.worker.js":19,"./resizer.dashboard.js":21}],23:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(){return l}function a(e,t){var n=document.getElementById("js-"+e+"-settings");t.classList.toggle("active"),n&&n.classList.toggle("active")}function s(){var e=[].concat(o(document.querySelectorAll(".tool-selection-btn")));e.forEach(function(e){if(e.classList.contains("active")){var t=e.getAttribute("data-tool");a(t,e)}})}function u(e){var t=e.target,n=t.getAttribute("data-tool");n&&n!==l&&(l=n,s(),a(n,t),d.show(n+" enabled"))}Object.defineProperty(n,"__esModule",{value:!0}),n.getCurrentTool=void 0;var c=e("./dropbox/dropbox.message.js"),d=r(c),l="resizer";document.getElementById("js-tools-btns").addEventListener("click",u,!1),n.getCurrentTool=i},{"./dropbox/dropbox.message.js":16}]},{},[20]);