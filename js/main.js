!function e(t,n,i){function r(s,a){if(!n[s]){if(!t[s]){var d="function"==typeof require&&require;if(!a&&d)return d(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[s]={exports:{}};t[s][0].call(c.exports,function(e){var n=t[s][1][e];return r(n?n:e)},c,c.exports,e,t,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e,t){e.disabled=t}function o(e){e>1?r(Z,!1):r(Z,!0)}function s(e){var t=document.getElementById("js-crop-remaining");return"remove"===e?void(t.textContent=""):void(t.textContent=U.images.length-1+" images remaining")}function a(e){document.getElementById("js-crop-image-name").textContent=e}function d(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],t=arguments.length<=1||void 0===arguments[1]?0:arguments[1];e&&(e=te.width>0?te.x:te.x+te.width),t&&(t=te.height>0?te.y:te.y+te.height),document.getElementById("js-crop-x").textContent=Math.round(e*re),document.getElementById("js-crop-y").textContent=Math.round(t*oe)}function u(e,t){document.getElementById("js-crop-width").textContent=0>e?-e:e,document.getElementById("js-crop-height").textContent=0>t?-t:t}function c(){var e=te,t=e.x,n=e.y,i=void 0;e.width&&e.height&&(i=$.getImageData(e.x,e.y,e.width,e.height),e.width<0&&(t+=e.width),e.height<0&&(n+=e.height)),$.fillStyle="rgba(0, 0, 0, .4)",$.fillRect(0,0,H.width,H.height),i&&$.putImageData(i,t,n),$.strokeStyle="#006494",$.strokeRect(e.x+.5,e.y+.5,e.width,e.height)}function g(){$.drawImage(Y,0,0,H.width,H.height),c()}function l(e){Y.addEventListener("load",function(){var e=Y.width/Y.height,t=window.innerWidth-212,n=window.innerHeight-40,i=Y.width,r=Y.height;(0,F.toggleElement)("add",V),i>t&&(i=t,r=i/e),r>n&&(r=n,i=r*e),H.width=i,H.height=r,re=Y.width/H.width,oe=Y.height/H.height,$.drawImage(Y,0,0,H.width,H.height)}),Y.src=e}function h(e){var t=arguments.length<=1||void 0===arguments[1]?"image/jpg":arguments[1],n=document.createElement("canvas"),i=n.getContext("2d"),r=Q;n.width=e.width,n.height=e.height,i.drawImage(e,0,0,n.width,n.height);var o=i.getImageData(r.x,r.y,r.width,r.height);return n.width=o.width,n.height=o.height,i.putImageData(o,0,0),{uri:n.toDataURL(t),width:n.width,height:n.height}}function m(e){var t=new Image;t.addEventListener("load",function(){var n=h(t,e.type);U.worker.postMessage({action:"add",image:{name:e.name.setByUser,type:e.type.slice(6),uri:n.uri}}),U.images.length||(s("remove"),H.removeEventListener("mousedown",x,!1),(0,F.toggleElement)("remove",V),U.generateZip())}),t.src=e.uri}function f(e){var t=H.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}function v(e,t){var n=4,i=te.x,r=te.y,o=i+te.width,s=r+te.height,a=e>=i-n&&o+n>=e||i+n>=e&&e>=o-n,d=t>=r-n&&s+n>=t||r+n>=t&&t>=s-n,u=t>=r-n&&r+n>=t,c=e>=o-n&&o+n>=e,g=t>=s-n&&s+n>=t,l=e>=i-n&&i+n>=e;if(u){if(l)return"nw";if(c)return"ne";if(a)return"n"}if(g){if(c)return"se";if(l)return"sw";if(a)return"s"}if(d){if(c)return"e";if(l)return"w"}return""}function p(e,t){var n=te.x,i=te.y,r=n+te.width,o=i+te.height,s=e>=n&&r>=e||n>=e&&e>=r,a=t>=i&&o>=t||i>=t&&t>=o;return s&&a}function w(e){return 0>e?0:e>H.width?H.width:e}function y(e){return 0>e?0:e>H.height?H.height:e}function E(e){var t=te,n={},i=f(e),r=i.x,o=i.y,s="";switch(r=w(r),o=y(o),ne){case"nw":n.x=r,n.y=o,n.width=t.x-r+t.width,n.height=t.y-o+t.height,s=C("nw","ne");break;case"ne":n.y=o,n.height=t.y-o+t.height,n.width=r-t.x,s=C("ne","nw");break;case"se":n.width=r-t.x,n.height=o-t.y,s=C("se","sw");break;case"sw":n.x=r,n.width=t.x-r+t.width,n.height=o-t.y,s=C("sw","se");break;case"n":n.y=o,n.height=t.y-o+t.height;break;case"e":n.width=r-t.x;break;case"s":n.height=o-t.y;break;case"w":n.x=r,n.width=t.x-r+t.width}s&&(H.style.cursor=s+"-resize"),Object.assign(te,n),requestAnimationFrame(g),L(),d(te.x,te.y)}function j(e,t){var n=te[e],i=te[t],r=H[t];0>n&&(te[e]=0),n+i>r?te[e]=r-i:0>n+i?te[e]=-i:n>r&&(te[e]=r),d(te.x,te.y)}function I(e,t){var n=e-te.x,i=t-te.y;return function(e){if(e.ctrlKey){var t=f(e),r=t.x,o=t.y;te.x=r-n,te.y=o-i,j("x","width"),j("y","height"),requestAnimationFrame(g),L()}}}function x(e){if(1===e.which){var t=f(e),n=t.x,i=t.y;ne=v(n,i),$.drawImage(Y,0,0,H.width,H.height),H.removeEventListener("mousemove",D,!1),document.removeEventListener("keydown",B,!1),ne&&te.width&&te.height?(c(),V.addEventListener("mousemove",E,!1),V.addEventListener("mouseup",P,!1)):e.ctrlKey&&p(n,i)?(ie=I(n,i),c(),V.addEventListener("mousemove",ie,!1),V.addEventListener("mouseup",O,!1)):($.fillStyle="rgba(0, 0, 0, .4)",$.fillRect(0,0,H.width,H.height),te.x=n,te.y=i,te.width=0,te.height=0,V.addEventListener("mousemove",k,!1),V.addEventListener("mouseup",W,!1))}}function k(e){var t=f(e),n=t.x,i=t.y;n=w(n),i=y(i),te.width=n-te.x,te.height=i-te.y,requestAnimationFrame(g),L(),d(n,i)}function b(){H.style.cursor="default",document.removeEventListener("keyup",b,!1)}function B(e){e.ctrlKey&&p(ee.x,ee.y)&&(H.style.cursor="move",document.addEventListener("keyup",b,!1))}function L(){Q.x=Math.round(te.x*re),Q.y=Math.round(te.y*oe),Q.width=Math.round(te.width*re),Q.height=Math.round(te.height*oe),u(Q.width,Q.height)}function M(e,t){V.removeEventListener("mousemove",e,!1),V.removeEventListener("mouseup",t,!1),te.width&&te.height?(H.addEventListener("mousemove",D,!1),document.addEventListener("keydown",B,!1),r(K,!1),r(G,!1)):(te={},d(0,0),u(0,0),H.style.cursor="default",$.drawImage(Y,0,0,H.width,H.height),r(K,!0),r(G,!0))}function C(e,t){var n=te.x,i=te.y,r=n+te.width,o=i+te.height;if(r>n){if(i>o)return t}else if(o>i)return t;return e}function D(e){var t=f(e),n=t.x,i=t.y;if(ee.x=n,ee.y=i,e.ctrlKey&&p(n,i))return void(H.style.cursor="move");var r=v(n,i);switch(r){case"nw":r=C("nw","ne");break;case"ne":r=C("ne","nw");break;case"sw":r=C("sw","se");break;case"se":r=C("se","sw")}H.style.cursor=r?r+"-resize":"default"}function P(){M(E,P)}function O(){M(ie,O)}function W(){M(k,W)}function T(){var e=U.images[0];U.initWorker(),a(e.name.original),l(e.uri),r(K,!0),r(G,!0),o(U.images.length),H.addEventListener("mousedown",x,!1),U.images.length>1&&s()}function _(e){o(U.images.length),r(K,!0),r(G,!0),U.images.length&&(s(),te={},a(e.name.original),d(0,0),u(0,0),l(e.uri))}function A(){var e=U.images.splice(0,1)[0];m(e),_(U.images[0])}function N(){U.images.splice(0,1),_(U.images[0])}function S(){return se?(se=!1,void(0,F.toggleElement)("remove",X)):(te={},d(0,0),u(0,0),s("remove"),(0,F.toggleElement)("remove",V),void U.worker.postMessage({action:"generate"}))}function z(){var e=h(Y),t=window.innerWidth-8,n=window.innerHeight-40,i=X.children[0],r=e.width,o=e.height,s=r/o;se=!0,(0,F.toggleElement)("add",X),r>t&&(r=t,o=r/s),o>n&&(o=n,r=o*s),i.style.width=Math.floor(r)+"px",i.style.height=Math.floor(o)+"px",i.src=e.uri}function q(){V.classList.remove("preload"),window.removeEventListener("load",q,!1)}Object.defineProperty(n,"__esModule",{value:!0}),n.init=void 0;var F=e("./main.js"),R=e("./process.js"),U=i(R),V=document.getElementById("js-crop"),H=document.getElementById("js-canvas"),$=H.getContext("2d"),K=document.getElementById("js-crop-ok"),Z=document.getElementById("js-crop-skip"),J=document.getElementById("js-crop-close"),G=document.getElementById("js-crop-preview-btn"),X=document.getElementById("js-crop-preview"),Y=new Image,Q={},ee={},te={},ne="",ie="",re=1,oe=1,se=!1;K.addEventListener("click",A,!1),Z.addEventListener("click",N,!1),J.addEventListener("click",S,!1),G.addEventListener("click",z,!1),window.addEventListener("load",q,!1),n.init=T},{"./main.js":3,"./process.js":4}],2:[function(e,t,n){"use strict";function i(e){y&&clearTimeout(y),y=setTimeout(function(){r()},e)}function r(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0];requestAnimationFrame(function(){document.getElementById("js-msg").innerHTML=e}),e&&i(2e3)}function o(e){requestAnimationFrame(function(){document.getElementById("js-progress-label").textContent=e})}function s(e){h.value+=e}function a(){h.value=0}function d(){return 100===Math.round(h.value)}function u(){o(""),(0,l.toggleMasks)("remove")}function c(){(0,l.toggleMasks)("add"),n.isWorking=w=!0,(0,l.toggleElement)("add",h),(0,l.toggleElement)("remove",m),(0,l.toggleElement)("add",v)}function g(){n.isWorking=w=!1,(0,l.toggleElement)("remove",h),(0,l.toggleElement)("remove",v),a(),u()}Object.defineProperty(n,"__esModule",{value:!0}),n.removeMasksAndLabel=n.setProgressLabel=n.updateProgress=n.resetProgress=n.resetDropbox=n.showMessage=n.downloadBtn=n.progressBar=n.processBtn=n.isCanceled=n.beforeWork=n.isWorking=n.cancelBtn=n.isDone=void 0;var l=e("./main.js"),h=document.getElementById("js-progress"),m=document.getElementById("js-process"),f=document.getElementById("js-download"),v=document.getElementById("js-cancel"),p=!1,w=!1,y=void 0;n.isDone=d,n.cancelBtn=v,n.isWorking=w,n.beforeWork=c,n.isCanceled=p,n.processBtn=m,n.progressBar=h,n.downloadBtn=f,n.showMessage=r,n.resetDropbox=g,n.resetProgress=a,n.updateProgress=s,n.setProgressLabel=o,n.removeMasksAndLabel=u},{"./main.js":3}],3:[function(e,t,n){"use strict";function i(e,t,n){t.classList[e](n)}function r(e,t){i(e,t,"show")}function o(e){i(e,document.getElementById("js-dropbox-label"),"mask"),i(e,document.getElementById("js-selections-mask"),"mask")}Object.defineProperty(n,"__esModule",{value:!0}),n.toggleElement=n.changeClass=n.toggleMasks=void 0,e("./dropbox.js"),e("./selections.js"),e("./read.js"),e("./process.js"),n.toggleMasks=o,n.changeClass=i,n.toggleElement=r},{"./dropbox.js":2,"./process.js":4,"./read.js":5,"./selections.js":6}],4:[function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e,t){j.showMessage(e),(0,k.toggleElement)("add",t)}function o(){B||(n.worker=B=new Worker("js/workers/worker1.js"),B.onmessage=function(e){n.zip=L=e.data,j.isWorking=!1,j.removeMasksAndLabel(),r("Images are ready for downloading.",j.downloadBtn),B.postMessage({action:"remove"})},B.onerror=function(e){console.log(e)})}function s(e){try{saveAs(e,"images.zip")}catch(t){var n=document.createElement("script");n.setAttribute("src","js/libs/FileSaver.min.js"),document.getElementsByTagName("body")[0].appendChild(n),n.onload=function(){saveAs(e,"images.zip")}}}function a(e){return"width"===e?"height":"width"}function d(e,t,n){var i=a(e),r="same"===t[e]?t[i]:t[e],o=n[e];return r.includes("%")?o*(Number.parseInt(r,10)/100):"original"===r||r===e?Number.parseInt(o,10):r===i?Number.parseInt(n[i],10):Number.parseInt(r,10)}function u(e,t){var n=t.width/t.height,i=0,r=0;return e.width&&(i=d("width",e,t),e.height?"same"===e.width&&(r=i):r=i/n),!r&&e.height&&(r=d("height",e,t),e.width?i||"same"!==e.height||(i=r):i=r*n),{width:i,height:r}}function c(e,t,n){var i=n.width,r=n.height,o=document.createElement("canvas");return o.width=i,o.height=r,o.getContext("2d").drawImage(e,0,0,i,r),o.toDataURL(t)}function g(){j.setProgressLabel("Generating Archive"),B.postMessage({action:"generate"})}function l(){setTimeout(function(){j.isCanceled||((0,k.toggleElement)("remove",j.progressBar),(0,k.toggleElement)("remove",j.cancelBtn),j.resetProgress(),g())},1e3)}function h(e,t){return function n(i,r){var o=i.splice(0,1)[0];if(j.updateProgress(r),B.postMessage({action:"add",image:{name:t.name.setByUser,uri:c(e,t.type,o),type:t.type.slice(6)}}),j.isDone()&&l(),i.length){var s=t.size*o.width*o.height/2e3+100;setTimeout(function(){j.isCanceled||n(i,r)},s)}}}function m(e,t){var n=100/(e.length*t.length);return function i(){var r=new Image,o=e.splice(0,1)[0];if(r.onload=function(){if(!j.isCanceled){var e=h(r,o),i={width:r.width,height:r.height},s=t.map(function(e){return u(e,i)});j.setProgressLabel("Processing: "+o.name.original),e(s,n)}},r.src=o.uri,e.length){var s=400*o.size+100;setTimeout(function(){j.isCanceled||i()},s)}}}function f(e){return e.length?(e=e.filter(function(e){return x.verifyValue(e.width,e.height)||x.verifyValue(e.height,e.width)}),e.length||r("No valid values",j.processBtn)):r("No dimensions specified",j.processBtn),e}function v(){for(var e=x.widthInputCointaner.children,t=x.heightInputContainer.children,n=[],i=0,r=e.length;r>i;i++){var o=e[i].value,s=t[i].value;(o||s)&&n.push({width:o,height:s})}return f(n)}function p(){var e=v();if(!e.length)return void j.resetDropbox();o(),j.beforeWork();var t=m(b,e);t(),x.saveToLocalStorage()}function w(){s(L)}function y(){j.isCanceled=!0,n.zip=L=null,b.length=0,j.resetDropbox(),j.showMessage("Work canceled.")}Object.defineProperty(n,"__esModule",{value:!0}),n.generateZip=n.initWorker=n.processImages=n.worker=n.images=n.zip=void 0;var E=e("./dropbox.js"),j=i(E),I=e("./selections.js"),x=i(I),k=e("./main.js"),b=[],B=void 0,L=void 0;j.processBtn.addEventListener("click",p,!1),j.downloadBtn.addEventListener("click",w,!1),j.cancelBtn.addEventListener("click",y,!1),n.zip=L,n.images=b,n.worker=B,n.processImages=p,n.initWorker=o,n.generateZip=g},{"./dropbox.js":2,"./main.js":3,"./selections.js":6}],5:[function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(){setTimeout(function(){return w.isCanceled?void 0:E.images.length?void(document.getElementById("js-crop-checkbox").checked?(w.resetDropbox(),I.init()):(w.resetProgress(),E.processImages())):(w.resetDropbox(),void w.showMessage("No images to process."))},1200)}function o(e){return e.includes("image")}function s(e){return e.slice(0,e.lastIndexOf("."))}function a(e){var t=document.getElementById("js-image-name").value||s(e),n=document.getElementById("js-image-name-seperator").value||"-";return t+n}function d(e){var t=new FileReader;t.readAsDataURL(e),t.onloadend=function(t){E.images.push({name:{original:e.name,setByUser:a(e.name)},type:e.type,size:e.size/1e6,uri:t.target.result})}}function u(e,t){var n=e[0];if(w.setProgressLabel("Reading: "+n.name),e=Array.prototype.slice.call(e,1),o(n.type)&&d(n),w.updateProgress(t),e.length||r(),e.length){var i=n.size/1e6*100+100;setTimeout(function(){w.isCanceled||u(e,t)},i)}}function c(e){var t=100/e.length;E.worker&&E.worker.postMessage({action:"remove"}),E.images.length&&(E.images.length=0),E.zip=null,w.isCanceled=!1,(0,v.toggleElement)("remove",w.downloadBtn),w.beforeWork(),u(e,t)}function g(e){var t=e.target.files;e.preventDefault(),t.length&&c(t)}function l(e){return k=0,(0,v.changeClass)("remove",e.target,"over"),e.stopPropagation(),e.preventDefault(),w.isWorking?void(e.dataTransfer.dropEffect="none"):(e.dataTransfer.dropEffect="copy",void c(e.dataTransfer.files))}function h(e){e.stopPropagation(),e.preventDefault()}function m(e){e.preventDefault(),w.isWorking||(k+=1,(0,v.changeClass)("add",e.target,"over"))}function f(e){w.isWorking||(k-=1,k||(0,v.changeClass)("remove",e.target,"over"))}var v=e("./main.js"),p=e("./dropbox.js"),w=i(p),y=e("./process.js"),E=i(y),j=e("./crop.js"),I=i(j),x=document.getElementById("js-dropbox"),k=0;document.getElementById("js-image-select").addEventListener("change",g,!1),x.addEventListener("dragover",h,!1),x.addEventListener("dragenter",m,!1),x.addEventListener("dragleave",f,!1),x.addEventListener("drop",l,!1),x.addEventListener("click",function(e){w.isWorking&&e.preventDefault()})},{"./crop.js":1,"./dropbox.js":2,"./main.js":3,"./process.js":4}],6:[function(e,t,n){"use strict";function i(){var e={numberOfInputs:p.value,widthInputValues:s(f.children),heightInputValues:s(v.children),imageName:w.value||"",imageNameSeperator:y.value||""};localStorage.setItem("selections",JSON.stringify(e))}function r(e,t){var n=/^\d+(px|%)?$|^same$|^original$|^width$|^height$/;return n.test(e)&&!("same"===e&&(!t||"same"===t))}function o(e,t){Array.prototype.forEach.call(e,function(e,n){e.value=t[n]})}function s(e){return Array.prototype.map.call(e,function(e){return e.value})}function a(){var e=document.createElement("input");return e.setAttribute("type","text"),e.classList.add("image-input"),e}function d(e){for(var t=document.createDocumentFragment(),n=0;e>n;n++)t.appendChild(a());return t}function u(e,t){var n=e.children.length;if(t>n){var i=t-n;e.appendChild(d(i))}else for(var r=n-t;r--;)n=e.children.length,e.removeChild(e.children[n-1])}function c(e){var t=Number.parseInt(e.target.value,10);u(f,t),u(v,t)}function g(e){var t=e.target;t.innerHTML="Settings"===t.innerHTML?"Selections":"Settings",(0,h.toggleElement)("toggle",document.getElementById("js-selections")),(0,h.toggleElement)("toggle",document.getElementById("js-settings"))}function l(e){e.target.classList.contains("image-input")&&document.getElementById("js-crop-checkbox").checked&&((0,m.showMessage)("Disable image cropping to change input values"),e.preventDefault())}Object.defineProperty(n,"__esModule",{value:!0}),n.verifyValue=n.saveToLocalStorage=n.heightInputContainer=n.widthInputCointaner=void 0;var h=e("./main.js"),m=e("./dropbox.js"),f=document.getElementById("js-width-input-container"),v=document.getElementById("js-height-input-container"),p=document.getElementById("js-select"),w=document.getElementById("js-image-name"),y=document.getElementById("js-image-name-seperator");!function(){var e=localStorage.getItem("selections");e&&(e=JSON.parse(e),p.value=e.numberOfInputs,u(f,e.numberOfInputs),u(v,e.numberOfInputs),o(f.children,e.widthInputValues),o(v.children,e.heightInputValues),w.value=e.imageName,y.value=e.imageNameSeperator)}(),p.addEventListener("click",c,!1),document.getElementById("js-input-container").addEventListener("keydown",l,!1),document.getElementById("js-settings-toggle").addEventListener("click",g,!1),n.widthInputCointaner=f,n.heightInputContainer=v,n.saveToLocalStorage=i,n.verifyValue=r},{"./dropbox.js":2,"./main.js":3}]},{},[3]);