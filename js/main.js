!function e(t,n,r){function i(s,a){if(!n[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[s]={exports:{}};t[s][0].call(d.exports,function(e){var n=t[s][1][e];return i(n?n:e)},d,d.exports,e,t,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e,t){e.disabled=t}function o(e){e>1?i(V,!1):i(V,!0)}function s(e){var t=document.getElementById("js-crop-remaining");return"remove"===e?void(t.textContent=""):void(t.textContent=z.images.length-1+" images remaining")}function a(e){document.getElementById("js-crop-image-name").textContent=e}function u(e,t){document.getElementById("js-crop-width").textContent=0>e?-e+"px":e+"px",document.getElementById("js-crop-height").textContent=0>t?-t+"px":t+"px"}function c(){var e=Z;R.lineJoin="miter",R.lineCap="square",R.strokeStyle="#000",R.lineWidth=3,R.strokeRect(e.x,e.y,e.width,e.height),R.strokeStyle="#fff",R.lineWidth=2,R.strokeRect(e.x,e.y,e.width,e.height)}function d(){R.drawImage(H,0,0,F.width,F.height),c()}function g(e){H.addEventListener("load",function(){var e=H.width/H.height,t=window.innerHeight-66,n=window.innerWidth-10,r=n/e;(0,S.toggleElement)("add",q),r>t&&(r=t,n=r*e),F.width=n,F.height=r,R.drawImage(H,0,0,F.width,F.height)}),H.src=e}function l(e){return new Promise(function(t){var n=new Image;n.addEventListener("load",function(){var r=document.createElement("canvas"),i=r.getContext("2d"),o=K;r.width=n.width,r.height=n.height,i.drawImage(n,0,0,r.width,r.height);var s=i.getImageData(o.x,o.y,o.width,o.height);r.width=s.width,r.height=s.height,i.putImageData(s,0,0),z.worker.postMessage({action:"add",image:{name:e.name.setByUser,uri:r.toDataURL(e.type),type:e.type.slice(6)}}),t()}),n.src=e.uri})}function m(e){var t=F.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}function h(e,t){var n=4,r=Z.x,i=Z.y,o=r+Z.width,s=i+Z.height,a=e>=r-n&&o+n>=e||r+n>=e&&e>=o-n,u=t>=i-n&&s+n>=t||i+n>=t&&t>=s-n,c=t>=i-n&&i+n>=t,d=e>=o-n&&o+n>=e,g=t>=s-n&&s+n>=t,l=e>=r-n&&r+n>=e;if(c){if(l)return"nw";if(d)return"ne";if(a)return"n"}if(g){if(d)return"se";if(l)return"sw";if(a)return"s"}if(u){if(d)return"e";if(l)return"w"}return""}function f(e,t){var n=Z.x,r=Z.y,i=n+Z.width,o=r+Z.height,s=e>=n&&i>=e||n>=e&&e>=i,a=t>=r&&o>=t||r>=t&&t>=o;return s&&a}function v(e){return 0>e?0:e>F.width?F.width:e}function p(e){return 0>e?0:e>F.height?F.height:e}function w(e){var t=Z,n={},r=m(e),i=r.x,o=r.y,s="";switch(i=v(i),o=p(o),G){case"nw":n.x=i,n.y=o,n.width=t.x-i+t.width,n.height=t.y-o+t.height,s=B("nw","ne");break;case"ne":n.y=o,n.height=t.y-o+t.height,n.width=i-t.x,s=B("ne","nw");break;case"se":n.width=i-t.x,n.height=o-t.y,s=B("se","sw");break;case"sw":n.x=i,n.width=t.x-i+t.width,n.height=o-t.y,s=B("sw","se");break;case"n":n.y=o,n.height=t.y-o+t.height;break;case"e":n.width=i-t.x;break;case"s":n.height=o-t.y;break;case"w":n.x=i,n.width=t.x-i+t.width}s&&(F.style.cursor=s+"-resize"),Object.assign(Z,n),requestAnimationFrame(d),b()}function y(e,t){var n=Z[e],r=Z[t],i=F[t];0>n&&(Z[e]=0),n+r>i?Z[e]=i-r:0>n+r?Z[e]=-r:n>i&&(Z[e]=i)}function E(e,t){var n=e-Z.x,r=t-Z.y;return function(e){if(e.ctrlKey){var t=m(e),i=t.x,o=t.y;Z.x=i-n,Z.y=o-r,y("x","width"),y("y","height"),d()}}}function j(e){if(1===e.which){var t=m(e),n=t.x,r=t.y;G=h(n,r),R.drawImage(H,0,0,F.width,F.height),F.removeEventListener("mousemove",C,!1),document.removeEventListener("keydown",x,!1),G&&Z.width&&Z.height?(c(),q.addEventListener("mousemove",w,!1),q.addEventListener("mouseup",M,!1)):e.ctrlKey&&f(n,r)?(X=E(n,r),c(),q.addEventListener("mousemove",X,!1),q.addEventListener("mouseup",P,!1)):(Z.x=n,Z.y=r,Z.width=0,Z.height=0,q.addEventListener("mousemove",k,!1),q.addEventListener("mouseup",D,!1))}}function k(e){var t=m(e),n=t.x,r=t.y;n=v(n),r=p(r),Z.width=n-Z.x,Z.height=r-Z.y,requestAnimationFrame(d),b()}function I(){F.style.cursor="default",document.removeEventListener("keyup",I,!1)}function x(e){e.ctrlKey&&f(J.x,J.y)&&(F.style.cursor="move",document.addEventListener("keyup",I,!1))}function b(){var e=H.width/F.width,t=H.height/F.height;K.x=Math.round(Z.x*e),K.y=Math.round(Z.y*t),K.width=Math.round(Z.width*e),K.height=Math.round(Z.height*t),u(K.width,K.height)}function L(){Z.width&&Z.height?(F.addEventListener("mousemove",C,!1),document.addEventListener("keydown",x,!1),i(U,!1)):(Z={},u(0,0),F.style.cursor="default",R.drawImage(H,0,0,F.width,F.height),i(U,!0))}function B(e,t){var n=Z.x,r=Z.y,i=n+Z.width,o=r+Z.height;if(i>n){if(r>o)return t}else if(o>r)return t;return e}function C(e){var t=m(e),n=t.x,r=t.y;if(J.x=n,J.y=r,e.ctrlKey&&f(n,r))return void(F.style.cursor="move");var i=h(n,r);switch(i){case"nw":i=B("nw","ne");break;case"ne":i=B("ne","nw");break;case"sw":i=B("sw","se");break;case"se":i=B("se","sw")}F.style.cursor=i?i+"-resize":"default"}function M(){q.removeEventListener("mousemove",w,!1),q.removeEventListener("mouseup",M,!1),L()}function P(){q.removeEventListener("mousemove",X,!1),q.removeEventListener("mouseup",P,!1),L()}function D(){q.removeEventListener("mousemove",k,!1),q.removeEventListener("mouseup",D,!1),L()}function O(){var e=z.images[0];z.initWorker(),a(e.name.original),g(e.uri),i(U,!0),o(z.images.length),F.addEventListener("mousedown",j,!1),z.images.length>1&&s()}function W(e){o(z.images.length),i(U,!0),z.images.length&&(s(),Z={},a(e.name.original),u(0,0),g(e.uri))}function T(){var e=z.images.splice(0,1)[0];l(e).then(function(){W(z.images[0]),z.images.length||(s("remove"),F.removeEventListener("mousedown",j,!1),(0,S.toggleElement)("remove",q),z.generateZip())})}function _(){z.images.splice(0,1),W(z.images[0])}function N(){Z={},u(0,0),s("remove"),(0,S.toggleElement)("remove",q),z.worker.postMessage({action:"generate"})}Object.defineProperty(n,"__esModule",{value:!0}),n.init=void 0;var S=e("./main.js"),A=e("./process.js"),z=r(A),q=document.getElementById("js-crop"),F=document.getElementById("js-canvas"),R=F.getContext("2d"),U=document.getElementById("js-crop-ok"),V=document.getElementById("js-crop-skip"),$=document.getElementById("js-crop-close"),H=new Image,K={},J={},Z={},G="",X="";U.addEventListener("click",T,!1),V.addEventListener("click",_,!1),$.addEventListener("click",N,!1),n.init=O},{"./main.js":3,"./process.js":4}],2:[function(e,t,n){"use strict";function r(e){y&&clearTimeout(y),y=setTimeout(function(){i()},e)}function i(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0];requestAnimationFrame(function(){document.getElementById("js-msg").innerHTML=e}),e&&r(2e3)}function o(e){requestAnimationFrame(function(){document.getElementById("js-progress-label").textContent=e})}function s(e){m.value+=e}function a(){m.value=0}function u(){return 100===Math.round(m.value)}function c(){o(""),(0,l.toggleMasks)("remove")}function d(){(0,l.toggleMasks)("add"),n.isWorking=w=!0,(0,l.toggleElement)("add",m),(0,l.toggleElement)("remove",h),(0,l.toggleElement)("add",v)}function g(){n.isWorking=w=!1,(0,l.toggleElement)("remove",m),(0,l.toggleElement)("remove",v),a(),c()}Object.defineProperty(n,"__esModule",{value:!0}),n.removeMasksAndLabel=n.setProgressLabel=n.updateProgress=n.resetProgress=n.resetDropbox=n.showMessage=n.downloadBtn=n.progressBar=n.processBtn=n.isCanceled=n.beforeWork=n.isWorking=n.cancelBtn=n.isDone=void 0;var l=e("./main.js"),m=document.getElementById("js-progress"),h=document.getElementById("js-process"),f=document.getElementById("js-download"),v=document.getElementById("js-cancel"),p=!1,w=!1,y=void 0;n.isDone=u,n.cancelBtn=v,n.isWorking=w,n.beforeWork=d,n.isCanceled=p,n.processBtn=h,n.progressBar=m,n.downloadBtn=f,n.showMessage=i,n.resetDropbox=g,n.resetProgress=a,n.updateProgress=s,n.setProgressLabel=o,n.removeMasksAndLabel=c},{"./main.js":3}],3:[function(e,t,n){"use strict";function r(e,t,n){t.classList[e](n)}function i(e,t){r(e,t,"show")}function o(e){r(e,document.getElementById("js-dropbox-label"),"mask"),r(e,document.getElementById("js-selections-mask"),"mask")}Object.defineProperty(n,"__esModule",{value:!0}),n.toggleElement=n.changeClass=n.toggleMasks=void 0,e("./dropbox.js"),e("./selections.js"),e("./read.js"),e("./process.js"),n.toggleMasks=o,n.changeClass=r,n.toggleElement=i},{"./dropbox.js":2,"./process.js":4,"./read.js":5,"./selections.js":6}],4:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e,t){j.showMessage(e),(0,x.toggleElement)("add",t)}function o(){L||(n.worker=L=new Worker("js/workers/worker1.js"),L.onmessage=function(e){n.zip=B=e.data,j.isWorking=!1,j.removeMasksAndLabel(),i("Images are ready for downloading.",j.downloadBtn),L.postMessage({action:"remove"})},L.onerror=function(e){console.log(e)})}function s(e){try{saveAs(e,"images.zip")}catch(t){var n=document.createElement("script");n.setAttribute("src","js/libs/FileSaver.min.js"),document.getElementsByTagName("body")[0].appendChild(n),n.onload=function(){saveAs(e,"images.zip")}}}function a(e){return"width"===e?"height":"width"}function u(e,t,n){var r=a(e),i="same"===t[e]?t[r]:t[e],o=n[e];return i.includes("%")?o*(Number.parseInt(i,10)/100):"original"===i||i===e?Number.parseInt(o,10):i===r?Number.parseInt(n[r],10):Number.parseInt(i,10)}function c(e,t){var n=t.width/t.height,r=0,i=0;return e.width&&(r=u("width",e,t),e.height?"same"===e.width&&(i=r):i=r/n),!i&&e.height&&(i=u("height",e,t),e.width?r||"same"!==e.height||(r=i):r=i*n),{width:r,height:i}}function d(e,t,n){var r=n.width,i=n.height,o=document.createElement("canvas");return o.width=r,o.height=i,o.getContext("2d").drawImage(e,0,0,r,i),o.toDataURL(t)}function g(){j.setProgressLabel("Generating Archive"),L.postMessage({action:"generate"})}function l(){setTimeout(function(){j.isCanceled||((0,x.toggleElement)("remove",j.progressBar),(0,x.toggleElement)("remove",j.cancelBtn),j.resetProgress(),g())},1e3)}function m(e,t){return function n(r,i){var o=r.splice(0,1)[0];if(j.updateProgress(i),L.postMessage({action:"add",image:{name:t.name.setByUser,uri:d(e,t.type,o),type:t.type.slice(6)}}),j.isDone()&&l(),r.length){var s=t.size*o.width*o.height/2e3+100;setTimeout(function(){j.isCanceled||n(r,i)},s)}}}function h(e,t){var n=100/(e.length*t.length);return function r(){var i=new Image,o=e.splice(0,1)[0];if(i.onload=function(){if(!j.isCanceled){var e=m(i,o),r={width:i.width,height:i.height},s=t.map(function(e){return c(e,r)});j.setProgressLabel("Processing: "+o.name.original),e(s,n)}},i.src=o.uri,e.length){var s=400*o.size+100;setTimeout(function(){j.isCanceled||r()},s)}}}function f(e){return e.length?(e=e.filter(function(e){return I.verifyValue(e.width,e.height)||I.verifyValue(e.height,e.width)}),e.length||i("No valid values",j.processBtn)):i("No dimensions specified",j.processBtn),e}function v(){for(var e=I.widthInputCointaner.children,t=I.heightInputContainer.children,n=[],r=0,i=e.length;i>r;r++){var o=e[r].value,s=t[r].value;(o||s)&&n.push({width:o,height:s})}return f(n)}function p(){var e=v();if(!e.length)return void j.resetDropbox();o(),j.beforeWork();var t=h(b,e);t(),I.saveToLocalStorage()}function w(){s(B)}function y(){j.isCanceled=!0,n.zip=B=null,b.length=0,j.resetDropbox(),j.showMessage("Work canceled.")}Object.defineProperty(n,"__esModule",{value:!0}),n.generateZip=n.initWorker=n.processImages=n.worker=n.images=n.zip=void 0;var E=e("./dropbox.js"),j=r(E),k=e("./selections.js"),I=r(k),x=e("./main.js"),b=[],L=void 0,B=void 0;j.processBtn.addEventListener("click",p,!1),j.downloadBtn.addEventListener("click",w,!1),j.cancelBtn.addEventListener("click",y,!1),n.zip=B,n.images=b,n.worker=L,n.processImages=p,n.initWorker=o,n.generateZip=g},{"./dropbox.js":2,"./main.js":3,"./selections.js":6}],5:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(){setTimeout(function(){return w.isCanceled?void 0:E.images.length?void(document.getElementById("js-crop-checkbox").checked?(w.resetDropbox(),k.init()):(w.resetProgress(),E.processImages())):(w.resetDropbox(),void w.showMessage("No images to process."))},1200)}function o(e){return e.includes("image")}function s(e){return e.slice(0,e.lastIndexOf("."))}function a(e){var t=document.getElementById("js-image-name").value||s(e),n=document.getElementById("js-image-name-seperator").value||"-";return t+n}function u(e){var t=new FileReader;t.readAsDataURL(e),t.onloadend=function(t){E.images.push({name:{original:e.name,setByUser:a(e.name)},type:e.type,size:e.size/1e6,uri:t.target.result})}}function c(e,t){var n=e[0];if(w.setProgressLabel("Reading: "+n.name),e=Array.prototype.slice.call(e,1),o(n.type)&&u(n),w.updateProgress(t),e.length||i(),e.length){var r=n.size/1e6*100+100;setTimeout(function(){w.isCanceled||c(e,t)},r)}}function d(e){var t=100/e.length;E.worker&&E.worker.postMessage({action:"remove"}),E.images.length&&(E.images.length=0),E.zip=null,w.isCanceled=!1,(0,v.toggleElement)("remove",w.downloadBtn),w.beforeWork(),c(e,t)}function g(e){var t=e.target.files;e.preventDefault(),t.length&&d(t)}function l(e){return x=0,(0,v.changeClass)("remove",e.target,"over"),e.stopPropagation(),e.preventDefault(),w.isWorking?void(e.dataTransfer.dropEffect="none"):(e.dataTransfer.dropEffect="copy",void d(e.dataTransfer.files))}function m(e){e.stopPropagation(),e.preventDefault()}function h(e){e.preventDefault(),w.isWorking||(x+=1,(0,v.changeClass)("add",e.target,"over"))}function f(e){w.isWorking||(x-=1,x||(0,v.changeClass)("remove",e.target,"over"))}var v=e("./main.js"),p=e("./dropbox.js"),w=r(p),y=e("./process.js"),E=r(y),j=e("./crop.js"),k=r(j),I=document.getElementById("js-dropbox"),x=0;document.getElementById("js-image-select").addEventListener("change",g,!1),I.addEventListener("dragover",m,!1),I.addEventListener("dragenter",h,!1),I.addEventListener("dragleave",f,!1),I.addEventListener("drop",l,!1),I.addEventListener("click",function(e){w.isWorking&&e.preventDefault()})},{"./crop.js":1,"./dropbox.js":2,"./main.js":3,"./process.js":4}],6:[function(e,t,n){"use strict";function r(){var e={numberOfInputs:p.value,widthInputValues:s(f.children),heightInputValues:s(v.children),imageName:w.value||"",imageNameSeperator:y.value||""};localStorage.setItem("Selections",JSON.stringify(e))}function i(e,t){var n=/^\d+(px|%)?$|^same$|^original$|^width$|^height$/;return n.test(e)&&!("same"===e&&(!t||"same"===t))}function o(e,t){Array.prototype.forEach.call(e,function(e,n){e.value=t[n]})}function s(e){return Array.prototype.map.call(e,function(e){return e.value})}function a(){var e=document.createElement("input");return e.setAttribute("type","text"),e.classList.add("image-input"),e}function u(e){for(var t=document.createDocumentFragment(),n=0;e>n;n++)t.appendChild(a());return t}function c(e,t){var n=e.children.length;if(t>n){var r=t-n;e.appendChild(u(r))}else for(var i=n-t;i--;)n=e.children.length,e.removeChild(e.children[n-1])}function d(e){var t=Number.parseInt(e.target.value,10);c(f,t),c(v,t)}function g(e){var t=e.target;t.innerHTML="Settings"===t.innerHTML?"Selections":"Settings",(0,m.toggleElement)("toggle",document.getElementById("js-selections")),(0,m.toggleElement)("toggle",document.getElementById("js-settings"))}function l(e){e.target.classList.contains("image-input")&&document.getElementById("js-crop-checkbox").checked&&((0,h.showMessage)("Disable image cropping to change input values"),e.preventDefault())}Object.defineProperty(n,"__esModule",{value:!0}),n.verifyValue=n.saveToLocalStorage=n.heightInputContainer=n.widthInputCointaner=void 0;var m=e("./main.js"),h=e("./dropbox.js"),f=document.getElementById("js-width-input-container"),v=document.getElementById("js-height-input-container"),p=document.getElementById("js-select"),w=document.getElementById("js-image-name"),y=document.getElementById("js-image-name-seperator");!function(){var e=localStorage.getItem("Selections");e&&(e=JSON.parse(e),p.value=e.numberOfInputs,c(f,e.numberOfInputs),c(v,e.numberOfInputs),o(f.children,e.widthInputValues),o(v.children,e.heightInputValues),w.value=e.imageName,y.value=e.imageNameSeperator)}(),p.addEventListener("input",d,!1),document.getElementById("js-input-container").addEventListener("keydown",l,!1),document.getElementById("js-settings-toggle").addEventListener("click",g,!1),n.widthInputCointaner=f,n.heightInputContainer=v,n.saveToLocalStorage=r,n.verifyValue=i},{"./dropbox.js":2,"./main.js":3}]},{},[3]);